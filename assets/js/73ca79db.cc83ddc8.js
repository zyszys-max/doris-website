"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([[298927],{15680:(e,r,n)=>{n.d(r,{xA:()=>c,yg:()=>u});var a=n(296540);function t(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function o(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?o(Object(n),!0).forEach((function(r){t(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}function i(e,r){if(null==e)return{};var n,a,t=function(e,r){if(null==e)return{};var n,a,t={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],r.indexOf(n)>=0||(t[n]=e[n]);return t}(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],r.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(t[n]=e[n])}return t}var p=a.createContext({}),l=function(e){var r=a.useContext(p),n=r;return e&&(n="function"==typeof e?e(r):s(s({},r),e)),n},c=function(e){var r=l(e.components);return a.createElement(p.Provider,{value:r},e.children)},g="mdxType",h={inlineCode:"code",wrapper:function(e){var r=e.children;return a.createElement(a.Fragment,{},r)}},d=a.forwardRef((function(e,r){var n=e.components,t=e.mdxType,o=e.originalType,p=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),g=l(n),d=t,u=g["".concat(p,".").concat(d)]||g[d]||h[d]||o;return n?a.createElement(u,s(s({ref:r},c),{},{components:n})):a.createElement(u,s({ref:r},c))}));function u(e,r){var n=arguments,t=r&&r.mdxType;if("string"==typeof e||t){var o=n.length,s=new Array(o);s[0]=d;var i={};for(var p in r)hasOwnProperty.call(r,p)&&(i[p]=r[p]);i.originalType=e,i[g]="string"==typeof e?e:t,s[1]=i;for(var l=2;l<o;l++)s[l]=n[l];return a.createElement.apply(null,s)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},820041:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>p,contentTitle:()=>s,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>l});var a=n(58168),t=(n(296540),n(15680));const o={title:"Release Doris Connectors",language:"en"},s=void 0,i={unversionedId:"release-and-verify/release-doris-connectors",id:"release-and-verify/release-doris-connectors",title:"Release Doris Connectors",description:"\x3c!--",source:"@site/community/release-and-verify/release-doris-connectors.md",sourceDirName:"release-and-verify",slug:"/release-and-verify/release-doris-connectors",permalink:"/community/release-and-verify/release-doris-connectors",draft:!1,tags:[],version:"current",frontMatter:{title:"Release Doris Connectors",language:"en"},sidebar:"community",previous:{title:"Release Doris Core",permalink:"/community/release-and-verify/release-doris-core"},next:{title:"Release Doris Shade",permalink:"/community/release-and-verify/release-doris-shade"}},p={},l=[{value:"Preparing for release",id:"preparing-for-release",level:2},{value:"Releasing to Maven",id:"releasing-to-maven",level:2},{value:"1. Prepare branch and tag",id:"1-prepare-branch-and-tag",level:3},{value:"2. Release to Maven staging",id:"2-release-to-maven-staging",level:3},{value:"3. Prepare svn",id:"3-prepare-svn",level:3},{value:"4. Voting",id:"4-voting",level:3},{value:"Finish publishing",id:"finish-publishing",level:2},{value:"APPENDIX: Releasing TO SNAPSHOT",id:"appendix-releasing-to-snapshot",level:2}],c={toc:l},g="wrapper";function h(e){let{components:r,...o}=e;return(0,t.yg)(g,(0,a.A)({},c,o,{components:r,mdxType:"MDXLayout"}),(0,t.yg)("h1",{id:"releases-doris-connectors"},"Releases Doris Connectors"),(0,t.yg)("p",null,"Doris Connectors currently contains:"),(0,t.yg)("ul",null,(0,t.yg)("li",{parentName:"ul"},"Flink Doris Connector"),(0,t.yg)("li",{parentName:"ul"},"Spark Doris Connector")),(0,t.yg)("p",null,"The code base is separate from the main Doris code base and is located at:"),(0,t.yg)("ul",null,(0,t.yg)("li",{parentName:"ul"},(0,t.yg)("a",{parentName:"li",href:"https://github.com/apache/doris-flink-connector"},"https://github.com/apache/doris-flink-connector")),(0,t.yg)("li",{parentName:"ul"},(0,t.yg)("a",{parentName:"li",href:"https://github.com/apache/doris-spark-connector"},"https://github.com/apache/doris-spark-connector"))),(0,t.yg)("h2",{id:"preparing-for-release"},"Preparing for release"),(0,t.yg)("p",null,"First, see the ",(0,t.yg)("a",{parentName:"p",href:"/community/release-and-verify/release-prepare"},"release preparation")," documentation to prepare for the release."),(0,t.yg)("h2",{id:"releasing-to-maven"},"Releasing to Maven"),(0,t.yg)("p",null,"Let's take the release of Spark Connector 1.2.0 as an example."),(0,t.yg)("h3",{id:"1-prepare-branch-and-tag"},"1. Prepare branch and tag"),(0,t.yg)("p",null,"Create a branch in the code base: release-1.2.0, and checkout to this branch."),(0,t.yg)("p",null,"Modify the version revision in the pom to the version number to be released, which is 1.2.0. And submit this modification, for example:"),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre"},'git commit -a -m "Commit for release 1.2.0"\n')),(0,t.yg)("p",null,"Create tag and push"),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre"},"git tag 1.2.0\ngit push origin 1.2.0\n")),(0,t.yg)("h3",{id:"2-release-to-maven-staging"},"2. Release to Maven staging"),(0,t.yg)("p",null,"Because Spark Connector releases different releases for different Spark versions (such as 2.3, 3.1, 3.2), we need to process each version separately at compile time."),(0,t.yg)("p",null,"Let's take Spark version 2.3 and scala version 2.11 as examples:"),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre"},"mvn clean install \\\n-Dspark.version=2.3.0 \\\n-Dscala.version=2.11 \\\n-Dspark.major.version=2.3\n")),(0,t.yg)("blockquote",null,(0,t.yg)("p",{parentName:"blockquote"},"Note: For related parameters, please refer to the compilation command in the build.sh script, and revision is the version number to be released this time.")),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre"},"mvn deploy \\\n-Papache-release \\\n-Dspark.version=2.3.0 \\\n-Dscala.version=2.11 \\\n-Dspark.major.version=2.3 \n")),(0,t.yg)("p",null,"After successful execution, you can find the newly released version in ",(0,t.yg)("a",{parentName:"p",href:"https://repository.apache.org/#stagingRepositories"},"https://repository.apache.org/#stagingRepositories"),":"),(0,t.yg)("p",null,(0,t.yg)("img",{src:n(409560).A,width:"1057",height:"955"})),(0,t.yg)("p",null,(0,t.yg)("strong",{parentName:"p"},"Note that the ",(0,t.yg)("inlineCode",{parentName:"strong"},".asc")," signature file needs to be included. ")),(0,t.yg)("p",null,"If the operation is wrong, you need to drop the staging. Then perform the above steps again."),(0,t.yg)("p",null,"After checking, click the ",(0,t.yg)("inlineCode",{parentName:"p"},"close")," button in the figure to complete the staging release."),(0,t.yg)("h3",{id:"3-prepare-svn"},"3. Prepare svn"),(0,t.yg)("p",null,"Check out the svn repository:"),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre"},"svn co https://dist.apache.org/repos/dist/dev/doris/\n")),(0,t.yg)("p",null,"Package tag source code, and generate signature file and sha256 verification file. Here we take ",(0,t.yg)("inlineCode",{parentName:"p"},"1.14_2.12-1.0.0")," as an example. Other tag operations are the same"),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre"},"git archive --format=tar release-1.2.0 --prefix=apache-doris-spark-connector-1.2.0-src/ | gzip > apache-doris-spark-connector-1.2.0-src.tar.gz\n\ngpg -u xxx@apache.org --armor --output apache-doris-spark-connector-1.2.0-src.tar.gz.asc --detach-sign apache-doris-spark-connector-1.2.0- src.tar.gz\nsha512sum apache-doris-spark-connector-1.2.0-src.tar.gz > apache-doris-spark-connector-1.2.0-src.tar.gz.sha512\n\nMac:\nshasum -a 512 apache-doris-spark-connector-1.2.0-src.tar.gz > apache-doris-spark-connector-1.2.0-src.tar.gz.sha512\n")),(0,t.yg)("p",null,"You end up with three files:"),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre"},"apache-doris-spark-connector-1.2.0-src.tar.gz\napache-doris-spark-connector-1.2.0-src.tar.gz.asc\napache-doris-spark-connector-1.2.0-src.tar.gz.sha512\n")),(0,t.yg)("p",null,"Move these three files to the svn directory:"),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre"},"doris/spark-connector/1.2.0/\n")),(0,t.yg)("p",null,"The final svn directory structure is similar to:"),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre"},"|____0.15\n| |____0.15.0-rc04\n| | |____apache-doris-0.15.0-incubating-src.tar.gz.sha512\n| | |____apache-doris-0.15.0-incubating-src.tar.gz.asc\n| | |____apache-doris-0.15.0-incubating-src.tar.gz\n|____KEYS\n|____spark-connector\n| |____1.2.0\n| | |____apache-doris-spark-connector-1.2.0-src.tar.gz\n| | |____apache-doris-spark-connector-1.2.0-src.tar.gz.asc\n| | |____apache-doris-spark-connector-1.2.0-src.tar.gz.sha512\n")),(0,t.yg)("p",null,"Among them, 0.15 is the directory of Doris main code, and ",(0,t.yg)("inlineCode",{parentName:"p"},"spark-connector/1.2.0")," is the content of this release."),(0,t.yg)("p",null,"Note, for the preparation of the KEYS file, please refer to the introduction in ",(0,t.yg)("a",{parentName:"p",href:"/community/release-and-verify/release-prepare"},"Release Preparation"),"."),(0,t.yg)("h3",{id:"4-voting"},"4. Voting"),(0,t.yg)("p",null,"Initiate a vote in the dev@doris mail group, the template is as follows:"),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre"},"Hi all,\n\nThis is a call for the vote to release Apache Doris Spark Connector 1.2.0\n\nThe git tag for the release:\nhttps://github.com/apache/doris-spark-connector/releases/tag/1.2.0\n\nRelease Notes are here:\nhttps://github.com/apache/doris-spark-connector/issues/109\n\nThanks to everyone who has contributed to this release.\n\nThe release candidates:\nhttps://dist.apache.org/repos/dist/dev/doris/spark-connector/1.2.0/\n\nMaven 2 staging repository:\nhttps://repository.apache.org/content/repositories/orgapachedoris-1031\n\n\nKEYS file is available here:\nhttps://downloads.apache.org/doris/KEYS\n\nTo verify and build, you can refer to the following link:\nhttps://doris.apache.org/community/release-and-verify/release-verify\n\nThe vote will be open for at least 72 hours.\n\n[ ] +1 Approve the release\n[ ] +0 No opinion\n[ ] -1 Do not release this package because ...\n")),(0,t.yg)("h2",{id:"finish-publishing"},"Finish publishing"),(0,t.yg)("p",null,"Please refer to the ",(0,t.yg)("a",{parentName:"p",href:"/community/release-and-verify/release-complete"},"Complete Release")," document to complete the entire release process."),(0,t.yg)("h2",{id:"appendix-releasing-to-snapshot"},"APPENDIX: Releasing TO SNAPSHOT"),(0,t.yg)("p",null,"Snapshot is not an Apache Release version, it is only used for preview before release. After being discussed and approved by the PMC, the Snapshot version can be released"),(0,t.yg)("p",null,"Switch to the spark connector directory, we take spark version 2.3, scala 2.11 as an example"),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre"},"cd spark-doris-connector\nmvn deploy \\\n-Dspark.version=2.3.0 \\\n-Dscala.version=2.11 \\\n-Dspark.major.version=2.3 \\\n")),(0,t.yg)("p",null,"Afterwards you can see the snapshot version here:"),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre"},"https://repository.apache.org/content/repositories/snapshots/org/apache/doris/doris-spark-connector/\n")))}h.isMDXComponent=!0},409560:(e,r,n)=>{n.d(r,{A:()=>a});const a=n.p+"assets/images/staging-repositories-4c394e1094a6aa8ac05d6bfea6b48627.png"}}]);