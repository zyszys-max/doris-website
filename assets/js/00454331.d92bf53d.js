"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([[486769],{15680:(e,t,r)=>{r.d(t,{xA:()=>c,yg:()=>y});var n=r(296540);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var i=n.createContext({}),p=function(e){var t=n.useContext(i),r=t;return e&&(r="function"==typeof e?e(t):l(l({},t),e)),r},c=function(e){var t=p(e.components);return n.createElement(i.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var r=e.components,o=e.mdxType,a=e.originalType,i=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),u=p(r),m=o,y=u["".concat(i,".").concat(m)]||u[m]||d[m]||a;return r?n.createElement(y,l(l({ref:t},c),{},{components:r})):n.createElement(y,l({ref:t},c))}));function y(e,t){var r=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=r.length,l=new Array(a);l[0]=m;var s={};for(var i in t)hasOwnProperty.call(t,i)&&(s[i]=t[i]);s.originalType=e,s[u]="string"==typeof e?e:o,l[1]=s;for(var p=2;p<a;p++)l[p]=r[p];return n.createElement.apply(null,l)}return n.createElement.apply(null,r)}m.displayName="MDXCreateElement"},875858:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>i,contentTitle:()=>l,default:()=>d,frontMatter:()=>a,metadata:()=>s,toc:()=>p});var n=r(58168),o=(r(296540),r(15680));const a={title:"Quick Start",language:"en"},l=void 0,s={unversionedId:"install/cluster-deployment/k8s-deploy/compute-storage-coupled/install-quickstart",id:"install/cluster-deployment/k8s-deploy/compute-storage-coupled/install-quickstart",title:"Quick Start",description:"\x3c!--",source:"@site/docs/install/cluster-deployment/k8s-deploy/compute-storage-coupled/install-quickstart.md",sourceDirName:"install/cluster-deployment/k8s-deploy/compute-storage-coupled",slug:"/install/cluster-deployment/k8s-deploy/compute-storage-coupled/install-quickstart",permalink:"/docs/dev/install/cluster-deployment/k8s-deploy/compute-storage-coupled/install-quickstart",draft:!1,tags:[],version:"current",frontMatter:{title:"Quick Start",language:"en"},sidebar:"docs",previous:{title:"Cluster Environment Requirements",permalink:"/docs/dev/install/cluster-deployment/k8s-deploy/install-env"},next:{title:"Deploying Doris Operator",permalink:"/docs/dev/install/cluster-deployment/k8s-deploy/compute-storage-coupled/install-operator"}},i={},p=[{value:"Step 1: Create a Kubernetes test cluster",id:"step-1-create-a-kubernetes-test-cluster",level:2},{value:"Step 2: Deploy Doris Operator",id:"step-2-deploy-doris-operator",level:2},{value:"Step 3: Deploy Doris cluster",id:"step-3-deploy-doris-cluster",level:2},{value:"Step 4: Connect and access the Doris cluster",id:"step-4-connect-and-access-the-doris-cluster",level:2}],c={toc:p},u="wrapper";function d(e){let{components:t,...r}=e;return(0,o.yg)(u,(0,n.A)({},c,r,{components:t,mdxType:"MDXLayout"}),(0,o.yg)("p",null,"This section describes how to deploy Doris Operator and Doris cluster in the test Kubernetes cluster.\nThe deployment operations are as follows:"),(0,o.yg)("ol",null,(0,o.yg)("li",{parentName:"ol"},"Create a Kubernetes test cluster"),(0,o.yg)("li",{parentName:"ol"},"Deploy Doris Operator"),(0,o.yg)("li",{parentName:"ol"},"Deploy Doris cluster"),(0,o.yg)("li",{parentName:"ol"},"Connect to Doris cluster")),(0,o.yg)("h2",{id:"step-1-create-a-kubernetes-test-cluster"},"Step 1: Create a Kubernetes test cluster"),(0,o.yg)("p",null,"This step briefly describes how to quickly build a single-node k8s cluster without a k8s cluster. If you already have a k8s cluster, please skip this step.\nKind is currently a common solution for creating a local Kubernetes test environment. Kind uses Docker containers as nodes to create and run Kubernetes clusters locally."),(0,o.yg)("ol",null,(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Deployment prerequisites",(0,o.yg)("br",{parentName:"p"}),"\n","Before deployment, you need to ensure that the following components are available in the environment:"),(0,o.yg)("table",{parentName:"li"},(0,o.yg)("thead",{parentName:"table"},(0,o.yg)("tr",{parentName:"thead"},(0,o.yg)("th",{parentName:"tr",align:null},"Components"),(0,o.yg)("th",{parentName:"tr",align:null},"Version requirements"))),(0,o.yg)("tbody",{parentName:"table"},(0,o.yg)("tr",{parentName:"tbody"},(0,o.yg)("td",{parentName:"tr",align:null},"Docker"),(0,o.yg)("td",{parentName:"tr",align:null},">","= 18.09")),(0,o.yg)("tr",{parentName:"tbody"},(0,o.yg)("td",{parentName:"tr",align:null},"kubectl"),(0,o.yg)("td",{parentName:"tr",align:null},">","=1.19")),(0,o.yg)("tr",{parentName:"tbody"},(0,o.yg)("td",{parentName:"tr",align:null},"kind"),(0,o.yg)("td",{parentName:"tr",align:null},">","=0.8.0"))))),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Deploy Kubernetes cluster using kind\nIn this example, kind 0.10.0 is used to install the Kubernetes cluster. The command is as follows:"),(0,o.yg)("pre",{parentName:"li"},(0,o.yg)("code",{parentName:"pre"},"   kind create cluster --image kindest/node:v1.20.2 --name test-doris\n")),(0,o.yg)("p",{parentName:"li"},"Expected output:"),(0,o.yg)("pre",{parentName:"li"},(0,o.yg)("code",{parentName:"pre"},'Creating cluster "test-doris" ...\n \u2713 Ensuring node image (kindest/node:v1.20.2)\n \u2713 Preparing nodes\n \u2713 Writing configuration\n \u2713 Starting control-plane\n \u2713 Installing CNI\n \u2713 Installing StorageClass\nSet kubectl context to "kind-test-doris"\nYou can now use your cluster with:\n'))),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Check the Kubernetes cluster status Use the following command to check the Kubernetes cluster status:"),(0,o.yg)("pre",{parentName:"li"},(0,o.yg)("code",{parentName:"pre"},"kubectl cluster-info --context kind-test-doris\n")),(0,o.yg)("p",{parentName:"li"},"Expected output:"),(0,o.yg)("pre",{parentName:"li"},(0,o.yg)("code",{parentName:"pre"},"Kubernetes control plane is running at https://127.0.0.1:40075\nKubeDNS is running at https://127.0.0.1:40075/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy\nTo further debug and diagnose cluster problems, use 'kubectl cluster-info dump'.\n")))),(0,o.yg)("h2",{id:"step-2-deploy-doris-operator"},"Step 2: Deploy Doris Operator"),(0,o.yg)("p",null,"Deploying Doris Operator consists of two parts: installing the definition and deploying the operator service:"),(0,o.yg)("ol",null,(0,o.yg)("li",{parentName:"ol"},"Installing Doris Operator CRD\nAdd the custom resource (CRD) of Doris Operator using the following command:",(0,o.yg)("pre",{parentName:"li"},(0,o.yg)("code",{parentName:"pre"},"kubectl create -f https://raw.githubusercontent.com/apache/doris-operator/master/config/crd/bases/doris.selectdb.com_dorisclusters.yaml\n")),"Expected output:",(0,o.yg)("pre",{parentName:"li"},(0,o.yg)("code",{parentName:"pre"},"customresourcedefinition.apiextensions.k8s.io/dorisclusters.doris.selectdb.com created\n"))),(0,o.yg)("li",{parentName:"ol"},"Install Doris Operator\nInstall Doris Operator using the following command:",(0,o.yg)("pre",{parentName:"li"},(0,o.yg)("code",{parentName:"pre"},"kubectl apply -f https://raw.githubusercontent.com/apache/doris-operator/master/config/operator/operator.yaml\n")),"Expected output:",(0,o.yg)("pre",{parentName:"li"},(0,o.yg)("code",{parentName:"pre"},"namespace/doris created\nrole.rbac.authorization.k8s.io/leader-election-role created\nrolebinding.rbac.authorization.k8s.io/leader-election-rolebinding created\nclusterrole.rbac.authorization.k8s.io/doris-operator created\nclusterrolebinding.rbac.authorization.k8s.io/doris-operator-rolebinding created\nserviceaccount/doris-operator created\ndeployment.apps/doris-operator created\n"))),(0,o.yg)("li",{parentName:"ol"},"Check the Doris Operator status\nCheck the deployment status of Doris Operator using the following command:",(0,o.yg)("pre",{parentName:"li"},(0,o.yg)("code",{parentName:"pre"},"kubectl get pods -n doris\n")),"  Expected output:",(0,o.yg)("pre",{parentName:"li"},(0,o.yg)("code",{parentName:"pre"},"NAME                              READY   STATUS    RESTARTS   AGE\ndoris-operator-7f578c86cb-nz6jn   1/1     Running   0          19m\n")),"For Doris Operator related configuration and other deployment methods, please refer to ",(0,o.yg)("a",{parentName:"li",href:"/docs/dev/install/cluster-deployment/k8s-deploy/compute-storage-coupled/install-operator"},"Deploying Doris Operator"),".")),(0,o.yg)("h2",{id:"step-3-deploy-doris-cluster"},"Step 3: Deploy Doris cluster"),(0,o.yg)("ol",null,(0,o.yg)("li",{parentName:"ol"},"Download the template Doris deployment template:",(0,o.yg)("pre",{parentName:"li"},(0,o.yg)("code",{parentName:"pre"},"curl -O https://raw.githubusercontent.com/apache/doris-operator/master/doc/examples/doriscluster-sample.yaml\n"))),(0,o.yg)("li",{parentName:"ol"},"Perform customized configuration as needed according to the doc of ",(0,o.yg)("a",{parentName:"li",href:"/docs/dev/install/cluster-deployment/k8s-deploy/compute-storage-coupled/install-config-cluster"},"Config Doris to Deploy"),". After the configuration is completed, deploy it with the following command:",(0,o.yg)("pre",{parentName:"li"},(0,o.yg)("code",{parentName:"pre"},"kubectl apply -f doriscluster-sample.yaml\n"))),(0,o.yg)("li",{parentName:"ol"},"Check the cluster deployment status:\nCheck the status of the cluster by checking the status of pods:",(0,o.yg)("pre",{parentName:"li"},(0,o.yg)("code",{parentName:"pre"},"kubectl get pods\n")),"Expected output:",(0,o.yg)("pre",{parentName:"li"},(0,o.yg)("code",{parentName:"pre"},"NAME                       READY   STATUS    RESTARTS   AGE\ndoriscluster-sample-fe-0   1/1     Running   0          2m\ndoriscluster-sample-be-0   1/1     Running   0          3m\n")),"Check the status of the deployed resources:",(0,o.yg)("pre",{parentName:"li"},(0,o.yg)("code",{parentName:"pre"},"kubectl get dcr -n doris\n")),"Expected output:",(0,o.yg)("pre",{parentName:"li"},(0,o.yg)("code",{parentName:"pre"},"NAME                  FESTATUS    BESTATUS    CNSTATUS   BROKERSTATUS\ndoriscluster-sample   available   available\n")))),(0,o.yg)("h2",{id:"step-4-connect-and-access-the-doris-cluster"},"Step 4: Connect and access the Doris cluster"),(0,o.yg)("p",null,"The Doris cluster is quickly deployed in the test environment. You can enter the container FE and use the MySQL Client to connect to Doris for test operations. For other access methods, refer to ",(0,o.yg)("a",{parentName:"p",href:"/docs/dev/install/cluster-deployment/k8s-deploy/compute-storage-coupled/install-config-cluster#access-configuration"},"Accessing Doris Cluster")," for configuration."),(0,o.yg)("ol",null,(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Get the FE container name:"),(0,o.yg)("pre",{parentName:"li"},(0,o.yg)("code",{parentName:"pre"},"kubectl get pod -n doris | grep fe\ndoriscluster-sample-fe-0          1/1     Running   0          16m\n")),(0,o.yg)("p",{parentName:"li"},"In this example, the FE container is named doriscluster-sample-fe-0.")),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Enter the FE container:"),(0,o.yg)("pre",{parentName:"li"},(0,o.yg)("code",{parentName:"pre"},"kubectl -n doris exec -it doriscluster-sample-fe-0 /bin/bash\n"))),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Use MySQL Client to connect to the Doris cluster in the FE container:"),(0,o.yg)("pre",{parentName:"li"},(0,o.yg)("code",{parentName:"pre"},"mysql -uroot -P9030 -h127.0.0.1\n")))))}d.isMDXComponent=!0}}]);