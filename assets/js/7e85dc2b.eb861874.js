"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([[466617],{15680:(e,t,n)=>{n.d(t,{xA:()=>s,yg:()=>d});var r=n(296540);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var p=r.createContext({}),i=function(e){var t=r.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):u(u({},t),e)),n},s=function(e){var t=i(e.components);return r.createElement(p.Provider,{value:t},e.children)},c="mdxType",g={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,p=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),c=i(n),m=a,d=c["".concat(p,".").concat(m)]||c[m]||g[m]||o;return n?r.createElement(d,u(u({ref:t},s),{},{components:n})):r.createElement(d,u({ref:t},s))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,u=new Array(o);u[0]=m;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l[c]="string"==typeof e?e:a,u[1]=l;for(var i=2;i<o;i++)u[i]=n[i];return r.createElement.apply(null,u)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},553017:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>u,default:()=>g,frontMatter:()=>o,metadata:()=>l,toc:()=>i});var r=n(58168),a=(n(296540),n(15680));const o={title:"Managing Compute Groups",language:"en"},u=void 0,l={unversionedId:"compute-storage-decoupled/managing-compute-cluster",id:"compute-storage-decoupled/managing-compute-cluster",title:"Managing Compute Groups",description:"\x3c!--",source:"@site/docs/compute-storage-decoupled/managing-compute-cluster.md",sourceDirName:"compute-storage-decoupled",slug:"/compute-storage-decoupled/managing-compute-cluster",permalink:"/docs/dev/compute-storage-decoupled/managing-compute-cluster",draft:!1,tags:[],version:"current",frontMatter:{title:"Managing Compute Groups",language:"en"},sidebar:"docs",previous:{title:"Managing Storage Vault",permalink:"/docs/dev/compute-storage-decoupled/managing-storage-vault"},next:{title:"File Cache",permalink:"/docs/dev/compute-storage-decoupled/file-cache"}},p={},i=[{value:"Viewing All Compute Groups",id:"viewing-all-compute-groups",level:2},{value:"Adding Compute Groups",id:"adding-compute-groups",level:2},{value:"Granting Compute Group Access",id:"granting-compute-group-access",level:2},{value:"Revoking Compute Group Access",id:"revoking-compute-group-access",level:2},{value:"Setting Default Compute Group",id:"setting-default-compute-group",level:2},{value:"Default Compute Group Selection Mechanism",id:"default-compute-group-selection-mechanism",level:2},{value:"Switching Compute Groups",id:"switching-compute-groups",level:2},{value:"Scaling Compute Groups",id:"scaling-compute-groups",level:2}],s={toc:i},c="wrapper";function g(e){let{components:t,...n}=e;return(0,a.yg)(c,(0,r.A)({},s,n,{components:t,mdxType:"MDXLayout"}),(0,a.yg)("p",null,"In a compute-storage decoupled architecture, one or more compute nodes (BE) can be grouped into a Compute Group. This document describes how to use compute groups, including operations such as:"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"Viewing all compute groups"),(0,a.yg)("li",{parentName:"ul"},"Granting compute group access"),(0,a.yg)("li",{parentName:"ul"},"Binding compute groups at the user level (",(0,a.yg)("inlineCode",{parentName:"li"},"default_compute_group"),") for user-level isolation")),(0,a.yg)("p",null,(0,a.yg)("em",{parentName:"p"},"Note"),"\nIn versions prior to 3.0.2, this was referred to as a Compute Cluster."),(0,a.yg)("h2",{id:"viewing-all-compute-groups"},"Viewing All Compute Groups"),(0,a.yg)("p",null,"You can view all compute groups owned by the current repository using ",(0,a.yg)("inlineCode",{parentName:"p"},"SHOW COMPUTE GROUPS"),"."),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-sql"},"SHOW COMPUTE GROUPS;\n")),(0,a.yg)("h2",{id:"adding-compute-groups"},"Adding Compute Groups"),(0,a.yg)("p",null,"Using ",(0,a.yg)("a",{parentName:"p",href:"/docs/dev/sql-manual/sql-statements/Cluster-Management-Statements/ALTER-SYSTEM-ADD-BACKEND"},"Add BE ")," to add a BE into a compute group, for example:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-sql"},'ALTER SYSTEM ADD BACKEND \'host:9050\' PROPERTIES ("tag.compute_group_name" = "new_group");\n')),(0,a.yg)("p",null,"The above sql will add ",(0,a.yg)("inlineCode",{parentName:"p"},"host:9050")," to compute group ",(0,a.yg)("inlineCode",{parentName:"p"},"new_group"),". The BE will be added to compute group ",(0,a.yg)("inlineCode",{parentName:"p"},"default_compute_group")," if you omit PROPERTIES statement, for example:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-sql"},"ALTER SYSTEM ADD BACKEND 'host:9050';\n")),(0,a.yg)("h2",{id:"granting-compute-group-access"},"Granting Compute Group Access"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-sql"},"GRANT USAGE_PRIV ON COMPUTE GROUP {compute_group_name} TO {user}\n")),(0,a.yg)("h2",{id:"revoking-compute-group-access"},"Revoking Compute Group Access"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-sql"},"REVOKE USAGE_PRIV ON COMPUTE GROUP {compute_group_name} FROM {user}\n")),(0,a.yg)("h2",{id:"setting-default-compute-group"},"Setting Default Compute Group"),(0,a.yg)("p",null,"To set the default compute group for the current user:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-sql"},"SET PROPERTY 'default_compute_group' = '{clusterName}';\n")),(0,a.yg)("p",null,"To set the default compute group for other users (this operation requires Admin privileges):"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-sql"},"SET PROPERTY FOR {user} 'default_compute_group' = '{clusterName}';\n")),(0,a.yg)("p",null,"To view the current user's default compute group, the value of ",(0,a.yg)("inlineCode",{parentName:"p"},"default_compute_group")," in the returned result is the default compute group:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-sql"},"SHOW PROPERTY;\n")),(0,a.yg)("p",null,"To view the default compute group of other users, this operation requires the current user to have relevant permissions, and the value of ",(0,a.yg)("inlineCode",{parentName:"p"},"default_compute_group")," in the returned result is the default compute group:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-sql"},"SHOW PROPERTY FOR {user};\n")),(0,a.yg)("p",null,"To view all available compute groups in the current repository:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-sql"},"SHOW COMPUTE GROUPS;\n")),(0,a.yg)("admonition",{title:"Note",type:"info"},(0,a.yg)("ul",{parentName:"admonition"},(0,a.yg)("li",{parentName:"ul"},"If the current user has an Admin role, for example: ",(0,a.yg)("inlineCode",{parentName:"li"},"CREATE USER jack IDENTIFIED BY '123456' DEFAULT ROLE \"admin\""),", then:",(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"They can set the default compute group for themselves and other users;"),(0,a.yg)("li",{parentName:"ul"},"They can view their own and other users' ",(0,a.yg)("inlineCode",{parentName:"li"},"PROPERTY"),"."))),(0,a.yg)("li",{parentName:"ul"},"If the current user does not have an Admin role, for example: ",(0,a.yg)("inlineCode",{parentName:"li"},"CREATE USER jack1 IDENTIFIED BY '123456'"),", then:",(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"They can set the default compute group for themselves;"),(0,a.yg)("li",{parentName:"ul"},"They can view their own ",(0,a.yg)("inlineCode",{parentName:"li"},"PROPERTY"),";"),(0,a.yg)("li",{parentName:"ul"},"They cannot view all compute groups, as this operation requires ",(0,a.yg)("inlineCode",{parentName:"li"},"GRANT ADMIN")," privileges."))),(0,a.yg)("li",{parentName:"ul"},"If the current user has not configured a default compute group, the existing system will trigger an error when performing data read/write operations. To resolve this issue, the user can execute the ",(0,a.yg)("inlineCode",{parentName:"li"},"use @cluster")," command to specify the compute group used by the current context, or use the ",(0,a.yg)("inlineCode",{parentName:"li"},"SET PROPERTY")," statement to set the default compute group."),(0,a.yg)("li",{parentName:"ul"},"If the current user has configured a default compute group, but that cluster is subsequently deleted, an error will also be triggered during data read/write operations. The user can execute the ",(0,a.yg)("inlineCode",{parentName:"li"},"use @cluster")," command to re-specify the compute group used by the current context, or use the ",(0,a.yg)("inlineCode",{parentName:"li"},"SET PROPERTY")," statement to update the default cluster settings."))),(0,a.yg)("h2",{id:"default-compute-group-selection-mechanism"},"Default Compute Group Selection Mechanism"),(0,a.yg)("p",null,"When a user has not explicitly set a default compute group, the system will automatically select a compute group with Active BE that the user has usage permissions for. Once the default compute group is determined in a specific session, it will remain unchanged during that session unless the user explicitly changes the default setting."),(0,a.yg)("p",null,"In different sessions, if the following situations occur, the system may automatically change the user's default compute group:"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"The user has lost usage permissions for the default compute group selected in the last session"),(0,a.yg)("li",{parentName:"ul"},"A compute group has been added or removed"),(0,a.yg)("li",{parentName:"ul"},"The previously selected default compute group no longer has Active BE")),(0,a.yg)("p",null,"Situations one and two will definitely lead to a change in the automatically selected default compute group, while situation three may lead to a change."),(0,a.yg)("h2",{id:"switching-compute-groups"},"Switching Compute Groups"),(0,a.yg)("p",null,"Users can specify the database and compute group to use in a compute-storage decoupled architecture."),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"Syntax")),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-sql"},"USE { [catalog_name.]database_name[@compute_group_name] | @compute_group_name }\n")),(0,a.yg)("p",null,"If the database or compute group name contains reserved keywords, the corresponding name must be enclosed in backticks ```."),(0,a.yg)("h2",{id:"scaling-compute-groups"},"Scaling Compute Groups"),(0,a.yg)("p",null,"You can scale compute groups by adding or removing BE using ",(0,a.yg)("inlineCode",{parentName:"p"},"ALTER SYSTEM ADD BACKEND")," and ",(0,a.yg)("inlineCode",{parentName:"p"},"ALTER SYSTEM DECOMMISION BACKEND"),"."))}g.isMDXComponent=!0}}]);