"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([[104325],{15680:(e,t,a)=>{a.d(t,{xA:()=>y,yg:()=>m});var n=a(296540);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var g=n.createContext({}),p=function(e){var t=n.useContext(g),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},y=function(e){var t=p(e.components);return n.createElement(g.Provider,{value:t},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},c=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,l=e.originalType,g=e.parentName,y=o(e,["components","mdxType","originalType","parentName"]),d=p(a),c=r,m=d["".concat(g,".").concat(c)]||d[c]||u[c]||l;return a?n.createElement(m,i(i({ref:t},y),{},{components:a})):n.createElement(m,i({ref:t},y))}));function m(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=a.length,i=new Array(l);i[0]=c;var o={};for(var g in t)hasOwnProperty.call(t,g)&&(o[g]=t[g]);o.originalType=e,o[d]="string"==typeof e?e:r,i[1]=o;for(var p=2;p<l;p++)i[p]=a[p];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}c.displayName="MDXCreateElement"},725906:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>g,contentTitle:()=>i,default:()=>u,frontMatter:()=>l,metadata:()=>o,toc:()=>p});var n=a(58168),r=(a(296540),a(15680));const l={title:"Delta Lake Catalog",language:"en"},i=void 0,o={unversionedId:"lakehouse/datalake-analytics/deltalake",id:"lakehouse/datalake-analytics/deltalake",title:"Delta Lake Catalog",description:"\x3c!--",source:"@site/docs/lakehouse/datalake-analytics/deltalake.md",sourceDirName:"lakehouse/datalake-analytics",slug:"/lakehouse/datalake-analytics/deltalake",permalink:"/docs/dev/lakehouse/datalake-analytics/deltalake",draft:!1,tags:[],version:"current",frontMatter:{title:"Delta Lake Catalog",language:"en"},sidebar:"docs",previous:{title:"BigQuery Catalog",permalink:"/docs/dev/lakehouse/datalake-analytics/bigquery"},next:{title:"Kudu Catalog",permalink:"/docs/dev/lakehouse/datalake-analytics/kudu"}},g={},p=[{value:"Instructions for Use",id:"instructions-for-use",level:2},{value:"Compiling the Delta Lake Connector Plugin",id:"compiling-the-delta-lake-connector-plugin",level:2},{value:"Deploying the Delta Lake Connector",id:"deploying-the-delta-lake-connector",level:2},{value:"Creating the Delta Lake Catalog",id:"creating-the-delta-lake-catalog",level:2},{value:"Column Type Mapping",id:"column-type-mapping",level:2}],y={toc:p},d="wrapper";function u(e){let{components:t,...a}=e;return(0,r.yg)(d,(0,n.A)({},y,a,{components:t,mdxType:"MDXLayout"}),(0,r.yg)("p",null,"Delta Lake Catalog is compatible with the ",(0,r.yg)("a",{parentName:"p",href:"https://doris.apache.org/community/how-to-contribute/trino-connector-developer-guide/"},"Trino Connector"),", using the Delta Lake Connector to access Delta Lake tables."),(0,r.yg)("blockquote",null,(0,r.yg)("p",{parentName:"blockquote"},"This feature is supported starting from Doris version 3.0.1.")),(0,r.yg)("admonition",{title:"Note",type:"tip"},(0,r.yg)("p",{parentName:"admonition"},"This is an experimental feature.")),(0,r.yg)("h2",{id:"instructions-for-use"},"Instructions for Use"),(0,r.yg)("ol",null,(0,r.yg)("li",{parentName:"ol"},"Before accessing Delta Lake tables with the Trino Catalog, you must first compile the Trino Delta Lake plugin and place it in the specified directory. Refer to the following steps for specific instructions."),(0,r.yg)("li",{parentName:"ol"},"The current Doris is compatible with the Trino 435 version plugin. Using a Trino plugin lower or higher than version 435 may cause compatibility issues."),(0,r.yg)("li",{parentName:"ol"},"Time Travel feature of Delta Lake is not supported at the moment."),(0,r.yg)("li",{parentName:"ol"},"Querying Delta Lake history information is not supported at the moment.")),(0,r.yg)("h2",{id:"compiling-the-delta-lake-connector-plugin"},"Compiling the Delta Lake Connector Plugin"),(0,r.yg)("blockquote",null,(0,r.yg)("p",{parentName:"blockquote"},"JDK version 17 is required.")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-Plain",metastring:"Text",Text:!0},"$ git clone https://github.com/apache/Doris-thirdparty.git\n$ cd Doris-thirdparty\n$ git checkout trino-435\n$ cd plugin/trino-delta-lake\n$ mvn clean install -DskipTest\n")),(0,r.yg)("p",null,"After compiling, you will find the ",(0,r.yg)("inlineCode",{parentName:"p"},"trino-delta-lake-435")," directory under ",(0,r.yg)("inlineCode",{parentName:"p"},"trino/plugin/trino-delta-lake/target/"),"."),(0,r.yg)("p",null,"You can also directly download the precompiled ",(0,r.yg)("a",{parentName:"p",href:"https://github.com/apache/Doris-thirdparty/releases/download/trino-435-20240724/trino-delta-lake-435-20240724.tar.gz"},"trino-delta-lake-435-20240724.tar.gz")," and extract it."),(0,r.yg)("h2",{id:"deploying-the-delta-lake-connector"},"Deploying the Delta Lake Connector"),(0,r.yg)("p",null,"Place the ",(0,r.yg)("inlineCode",{parentName:"p"},"trino-delta-lake-435/")," directory in the ",(0,r.yg)("inlineCode",{parentName:"p"},"connectors/")," directory of all FE and BE deployment paths. (If it does not exist, you can create it manually)."),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-Plain",metastring:"Text",Text:!0},"\u251c\u2500\u2500 bin\n\u251c\u2500\u2500 conf\n\u251c\u2500\u2500 connectors\n\u2502   \u251c\u2500\u2500 trino-delta-lake-435\n...\n")),(0,r.yg)("p",null,"After deployment, it is recommended to restart the FE and BE nodes to ensure the Connector is correctly loaded."),(0,r.yg)("h2",{id:"creating-the-delta-lake-catalog"},"Creating the Delta Lake Catalog"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sql"},'create catalog delta_lake_catalog properties ( \n    "type"="trino-connector", \n    "trino.connector.name"="delta_lake",\n    "trino.hive.metastore"="thrift",\n    "trino.hive.metastore.uri"= "thrift://ip:portrait ",\n    "trino.hive.config.resources"="/path/to/core-site.xml,/path/to/hdfs-site.xml"\n);\n')),(0,r.yg)("p",null,"Note: Properties prefixed with ",(0,r.yg)("inlineCode",{parentName:"p"},"trino.")," are native Trino properties. For more information about Delta Lake properties, refer to the ",(0,r.yg)("a",{parentName:"p",href:"https://trino.io/docs/current/connector/delta-lake.html"},"Trino documentation"),"."),(0,r.yg)("h2",{id:"column-type-mapping"},"Column Type Mapping"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:null},"Delta Lake"),(0,r.yg)("th",{parentName:"tr",align:null},"Trino"),(0,r.yg)("th",{parentName:"tr",align:null},"Doris"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"BOOLEAN"),(0,r.yg)("td",{parentName:"tr",align:null},"BOOLEAN"),(0,r.yg)("td",{parentName:"tr",align:null},"BOOLEAN")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"INTEGER"),(0,r.yg)("td",{parentName:"tr",align:null},"INTEGER"),(0,r.yg)("td",{parentName:"tr",align:null},"INT")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"BYTE"),(0,r.yg)("td",{parentName:"tr",align:null},"TINYINT"),(0,r.yg)("td",{parentName:"tr",align:null},"TINYINT")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"SHORT"),(0,r.yg)("td",{parentName:"tr",align:null},"SMALLINT"),(0,r.yg)("td",{parentName:"tr",align:null},"SMALLINT")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"LONG"),(0,r.yg)("td",{parentName:"tr",align:null},"BIGINT"),(0,r.yg)("td",{parentName:"tr",align:null},"BIGINT")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"FLOAT"),(0,r.yg)("td",{parentName:"tr",align:null},"REAL"),(0,r.yg)("td",{parentName:"tr",align:null},"FLOAT")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"DOUBLE"),(0,r.yg)("td",{parentName:"tr",align:null},"DOUBLE"),(0,r.yg)("td",{parentName:"tr",align:null},"DOUBLE")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"DECIMAL(p,s)"),(0,r.yg)("td",{parentName:"tr",align:null},"DECIMAL(p,s)"),(0,r.yg)("td",{parentName:"tr",align:null},"DECIMAL(p,s)")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"STRING"),(0,r.yg)("td",{parentName:"tr",align:null},"VARCHAR"),(0,r.yg)("td",{parentName:"tr",align:null},"STRING")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"BINARY"),(0,r.yg)("td",{parentName:"tr",align:null},"VARBINARY"),(0,r.yg)("td",{parentName:"tr",align:null},"STRING")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"DATE"),(0,r.yg)("td",{parentName:"tr",align:null},"DATE"),(0,r.yg)("td",{parentName:"tr",align:null},"DATE")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"TIMESTAMPNTZ (TIMESTAMP","_","NTZ)"),(0,r.yg)("td",{parentName:"tr",align:null},"TIMESTAMP(6)"),(0,r.yg)("td",{parentName:"tr",align:null},"DATETIME")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"TIMESTAMP"),(0,r.yg)("td",{parentName:"tr",align:null},"TIMESTAMP(3) WITH TIME ZONE"),(0,r.yg)("td",{parentName:"tr",align:null},"DATETIME")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"ARRAY"),(0,r.yg)("td",{parentName:"tr",align:null},"ARRAY"),(0,r.yg)("td",{parentName:"tr",align:null},"ARRAY")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"MAP"),(0,r.yg)("td",{parentName:"tr",align:null},"MAP"),(0,r.yg)("td",{parentName:"tr",align:null},"MAP")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"STRUCT"),(0,r.yg)("td",{parentName:"tr",align:null},"ROW"),(0,r.yg)("td",{parentName:"tr",align:null},"STRUCT")))))}u.isMDXComponent=!0}}]);