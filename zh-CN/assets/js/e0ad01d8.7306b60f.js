"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([[617346],{15680:(e,r,o)=>{o.d(r,{xA:()=>u,yg:()=>g});var n=o(296540);function a(e,r,o){return r in e?Object.defineProperty(e,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[r]=o,e}function t(e,r){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),o.push.apply(o,n)}return o}function l(e){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?t(Object(o),!0).forEach((function(r){a(e,r,o[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):t(Object(o)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(o,r))}))}return e}function m(e,r){if(null==e)return{};var o,n,a=function(e,r){if(null==e)return{};var o,n,a={},t=Object.keys(e);for(n=0;n<t.length;n++)o=t[n],r.indexOf(o)>=0||(a[o]=e[o]);return a}(e,r);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);for(n=0;n<t.length;n++)o=t[n],r.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}var s=n.createContext({}),i=function(e){var r=n.useContext(s),o=r;return e&&(o="function"==typeof e?e(r):l(l({},r),e)),o},u=function(e){var r=i(e.components);return n.createElement(s.Provider,{value:r},e.children)},d="mdxType",p={inlineCode:"code",wrapper:function(e){var r=e.children;return n.createElement(n.Fragment,{},r)}},c=n.forwardRef((function(e,r){var o=e.components,a=e.mdxType,t=e.originalType,s=e.parentName,u=m(e,["components","mdxType","originalType","parentName"]),d=i(o),c=a,g=d["".concat(s,".").concat(c)]||d[c]||p[c]||t;return o?n.createElement(g,l(l({ref:r},u),{},{components:o})):n.createElement(g,l({ref:r},u))}));function g(e,r){var o=arguments,a=r&&r.mdxType;if("string"==typeof e||a){var t=o.length,l=new Array(t);l[0]=c;var m={};for(var s in r)hasOwnProperty.call(r,s)&&(m[s]=r[s]);m.originalType=e,m[d]="string"==typeof e?e:a,l[1]=m;for(var i=2;i<t;i++)l[i]=o[i];return n.createElement.apply(null,l)}return n.createElement.apply(null,o)}c.displayName="MDXCreateElement"},8934:(e,r,o)=>{o.r(r),o.d(r,{assets:()=>s,contentTitle:()=>l,default:()=>p,frontMatter:()=>t,metadata:()=>m,toc:()=>i});var n=o(58168),a=(o(296540),o(15680));const t={title:"\u4f7f\u7528Workload Group\u7ba1\u7406\u5185\u5b58\u8d44\u6e90",language:"zh-CN"},l=void 0,m={unversionedId:"admin-manual/resource-admin/use-workload-mem-limit",id:"admin-manual/resource-admin/use-workload-mem-limit",title:"\u4f7f\u7528Workload Group\u7ba1\u7406\u5185\u5b58\u8d44\u6e90",description:"\x3c!--",source:"@site/i18n/zh-CN/docusaurus-plugin-content-docs/current/admin-manual/resource-admin/use-workload-mem-limit.md",sourceDirName:"admin-manual/resource-admin",slug:"/admin-manual/resource-admin/use-workload-mem-limit",permalink:"/zh-CN/docs/dev/admin-manual/resource-admin/use-workload-mem-limit",draft:!1,tags:[],version:"current",frontMatter:{title:"\u4f7f\u7528Workload Group\u7ba1\u7406\u5185\u5b58\u8d44\u6e90",language:"zh-CN"},sidebar:"docs",previous:{title:"\u5927\u67e5\u8be2\u7194\u65ad",permalink:"/zh-CN/docs/dev/admin-manual/resource-admin/workload-fusing"},next:{title:"\u4f7f\u7528Workload Group\u7ba1\u7406CPU\u8d44\u6e90",permalink:"/zh-CN/docs/dev/admin-manual/resource-admin/use-workload-cpu-limit"}},s={},i=[{value:"\u6d4b\u8bd5\u5185\u5b58\u786c\u9650",id:"\u6d4b\u8bd5\u5185\u5b58\u786c\u9650",level:2},{value:"\u6d4b\u8bd5\u73af\u5883",id:"\u6d4b\u8bd5\u73af\u5883",level:3},{value:"\u6d4b\u8bd5\u4e0d\u5f00\u542fWorkload Group\u7684\u5185\u5b58\u786c\u9650",id:"\u6d4b\u8bd5\u4e0d\u5f00\u542fworkload-group\u7684\u5185\u5b58\u786c\u9650",level:3},{value:"\u6d4b\u8bd5\u5f00\u542fWorkload Group\u7684\u5185\u5b58\u786c\u9650",id:"\u6d4b\u8bd5\u5f00\u542fworkload-group\u7684\u5185\u5b58\u786c\u9650",level:3},{value:"\u4f7f\u7528\u5efa\u8bae",id:"\u4f7f\u7528\u5efa\u8bae",level:2}],u={toc:i},d="wrapper";function p(e){let{components:r,...o}=e;return(0,a.yg)(d,(0,n.A)({},u,o,{components:r,mdxType:"MDXLayout"}),(0,a.yg)("p",null,"Adhoc\u7c7b\u67e5\u8be2\u901a\u5e38\u8f93\u5165\u7684SQL\u4e0d\u786e\u5b9a\uff0c\u4f7f\u7528\u7684\u5185\u5b58\u8d44\u6e90\u4e5f\u4e0d\u786e\u5b9a\uff0c\u56e0\u6b64\u5b58\u5728\u5c11\u6570\u67e5\u8be2\u5360\u7528\u5f88\u5927\u5185\u5b58\u7684\u98ce\u9669\u3002\n\u53ef\u4ee5\u5bf9\u8fd9\u7c7b\u8d1f\u8f7d\u53ef\u4ee5\u5212\u5206\u5230\u72ec\u7acb\u7684\u5206\u7ec4\uff0c\u901a\u8fc7Workload Group\u5bf9\u5185\u5b58\u7684\u786c\u9650\u7684\u529f\u80fd\uff0c\u907f\u514d\u7a81\u53d1\u6027\u7684\u5927\u67e5\u8be2\u5360\u6ee1\u6240\u6709\u5185\u5b58\uff0c\u5bfc\u81f4\u5176\u4ed6\u67e5\u8be2\u6ca1\u6709\u53ef\u7528\u5185\u5b58\u6216\u8005OOM\u3002\n\u5f53\u8fd9\u4e2aWorkload Group\u7684\u5185\u5b58\u4f7f\u7528\u8d85\u8fc7\u914d\u7f6e\u7684\u786c\u9650\u503c\u65f6\uff0c\u4f1a\u901a\u8fc7\u6740\u6b7b\u67e5\u8be2\u7684\u65b9\u5f0f\u91ca\u653e\u5185\u5b58\uff0c\u907f\u514d\u8fdb\u7a0b\u5185\u5b58\u88ab\u6253\u6ee1\u3002"),(0,a.yg)("h2",{id:"\u6d4b\u8bd5\u5185\u5b58\u786c\u9650"},"\u6d4b\u8bd5\u5185\u5b58\u786c\u9650"),(0,a.yg)("h3",{id:"\u6d4b\u8bd5\u73af\u5883"},"\u6d4b\u8bd5\u73af\u5883"),(0,a.yg)("p",null,"1FE\uff0c1BE\uff0cBE\u914d\u7f6e\u4e3a96\u6838\uff0c\u5185\u5b58\u5927\u5c0f\u4e3a375G\u3002"),(0,a.yg)("p",null,"\u6d4b\u8bd5\u6570\u636e\u96c6\u4e3aclickbench\uff0c\u6d4b\u8bd5\u65b9\u6cd5\u4e3a\u4f7f\u7528jmeter\u8d77\u4e09\u5e76\u53d1\u6267\u884cq29\u3002"),(0,a.yg)("h3",{id:"\u6d4b\u8bd5\u4e0d\u5f00\u542fworkload-group\u7684\u5185\u5b58\u786c\u9650"},"\u6d4b\u8bd5\u4e0d\u5f00\u542fWorkload Group\u7684\u5185\u5b58\u786c\u9650"),(0,a.yg)("ol",null,(0,a.yg)("li",{parentName:"ol"},"\u67e5\u770b\u8fdb\u7a0b\u4f7f\u7528\u5185\u5b58\u3002ps\u547d\u4ee4\u8f93\u51fa\u7b2c\u56db\u5217\u4ee3\u8868\u8fdb\u7a0b\u4f7f\u7528\u7684\u7269\u7406\u5185\u5b58\u7684\u7528\u91cf\uff0c\u5355\u4f4d\u4e3akb\uff0c\u53ef\u4ee5\u770b\u5230\u5f53\u524d\u6d4b\u8bd5\u8d1f\u8f7d\u4e0b\uff0c\u8fdb\u7a0b\u7684\u5185\u5b58\u4f7f\u7528\u4e3a7.7G\u5de6\u53f3\u3002")),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre"},"[ ~]$ ps -eo pid,comm,%mem,rss | grep 1407481\n1407481 doris_be         2.0 7896792\n[ ~]$ ps -eo pid,comm,%mem,rss | grep 1407481\n1407481 doris_be         2.0 7929692\n[ ~]$ ps -eo pid,comm,%mem,rss | grep 1407481\n1407481 doris_be         2.0 8101232\n")),(0,a.yg)("ol",{start:2},(0,a.yg)("li",{parentName:"ol"},"\u4f7f\u7528Doris\u7cfb\u7edf\u8868\u67e5\u770b\u5f53\u524dWorkload Group\u7684\u5185\u5b58\u7528\u91cf\uff0cWorkload Group\u7684\u5185\u5b58\u7528\u91cf\u4e3a5.8G\u5de6\u53f3\u3002")),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre"},"mysql [information_schema]>select MEMORY_USAGE_BYTES / 1024/ 1024 as wg_mem_used_mb from workload_group_resource_usage where workload_group_id=11201;\n+-------------------+\n| wg_mem_used_mb    |\n+-------------------+\n| 5797.524360656738 |\n+-------------------+\n1 row in set (0.01 sec)\n\nmysql [information_schema]>select MEMORY_USAGE_BYTES / 1024/ 1024 as wg_mem_used_mb from workload_group_resource_usage where workload_group_id=11201;\n+-------------------+\n| wg_mem_used_mb    |\n+-------------------+\n| 5840.246627807617 |\n+-------------------+\n1 row in set (0.02 sec)\n\nmysql [information_schema]>select MEMORY_USAGE_BYTES / 1024/ 1024 as wg_mem_used_mb from workload_group_resource_usage where workload_group_id=11201;\n+-------------------+\n| wg_mem_used_mb    |\n+-------------------+\n| 5878.394917488098 |\n+-------------------+\n1 row in set (0.02 sec)\n")),(0,a.yg)("p",null,"\u8fd9\u91cc\u53ef\u4ee5\u770b\u5230\u8fdb\u7a0b\u7684\u5185\u5b58\u4f7f\u7528\u901a\u5e38\u8981\u8fdc\u5927\u4e8e\u4e00\u4e2aWorkload Group\u7684\u5185\u5b58\u7528\u91cf\uff0c\u5373\u4f7f\u8fdb\u7a0b\u5185\u53ea\u6709\u4e00\u4e2aWorkload Group\u5728\u8dd1\uff0c\u8fd9\u662f\u56e0\u4e3aWorkload Group\u53ea\u7edf\u8ba1\u4e86\u67e5\u8be2\u548c\u90e8\u5206\u5bfc\u5165\u7684\u5185\u5b58\uff0c\u8fdb\u7a0b\u5185\u7684\u5176\u4ed6\u7ec4\u4ef6\u6bd4\u5982\u5143\u6570\u636e\uff0c\u5404\u79cdCache\u7684\u5185\u5b58\u662f\u4e0d\u8ba1\u7b97Workload Group\u5185\u7684\uff0c\u4e5f\u4e0d\u7531Workload Group\u7ba1\u7406\u3002"),(0,a.yg)("h3",{id:"\u6d4b\u8bd5\u5f00\u542fworkload-group\u7684\u5185\u5b58\u786c\u9650"},"\u6d4b\u8bd5\u5f00\u542fWorkload Group\u7684\u5185\u5b58\u786c\u9650"),(0,a.yg)("ol",null,(0,a.yg)("li",{parentName:"ol"},"\u6267\u884cSQL\u547d\u4ee4\u4fee\u6539\u5185\u5b58\u914d\u7f6e\u3002")),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre"},"alter workload group g2 properties('memory_limit'='0.5%');\nalter workload group g2 properties('enable_memory_overcommit'='false');\n")),(0,a.yg)("ol",{start:2},(0,a.yg)("li",{parentName:"ol"},"\u6267\u884c\u540c\u6837\u7684\u6d4b\u8bd5\uff0c\u67e5\u770b\u7cfb\u7edf\u8868\u7684\u5185\u5b58\u7528\u91cf\uff0c\u5185\u5b58\u7528\u91cf\u4e3a1.5G\u5de6\u53f3\u3002")),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre"},"mysql [information_schema]>select MEMORY_USAGE_BYTES / 1024/ 1024 as wg_mem_used_mb from workload_group_resource_usage where workload_group_id=11201;\n+--------------------+\n| wg_mem_used_mb     |\n+--------------------+\n| 1575.3877239227295 |\n+--------------------+\n1 row in set (0.02 sec)\n\nmysql [information_schema]>select MEMORY_USAGE_BYTES / 1024/ 1024 as wg_mem_used_mb from workload_group_resource_usage where workload_group_id=11201;\n+------------------+\n| wg_mem_used_mb   |\n+------------------+\n| 1668.77405834198 |\n+------------------+\n1 row in set (0.01 sec)\n\nmysql [information_schema]>select MEMORY_USAGE_BYTES / 1024/ 1024 as wg_mem_used_mb from workload_group_resource_usage where workload_group_id=11201;\n+--------------------+\n| wg_mem_used_mb     |\n+--------------------+\n| 499.96760272979736 |\n+--------------------+\n1 row in set (0.01 sec)\n")),(0,a.yg)("ol",{start:3},(0,a.yg)("li",{parentName:"ol"},"\u4f7f\u7528ps\u547d\u4ee4\u67e5\u770b\u8fdb\u7a0b\u7684\u5185\u5b58\u7528\u91cf\uff0c\u5185\u5b58\u7528\u91cf\u4e3a3.8G\u5de6\u53f3\u3002")),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre"},"[ ~]$ ps -eo pid,comm,%mem,rss | grep 1407481\n1407481 doris_be         1.0 4071364\n[ ~]$ ps -eo pid,comm,%mem,rss | grep 1407481\n1407481 doris_be         1.0 4059012\n[ ~]$ ps -eo pid,comm,%mem,rss | grep 1407481\n1407481 doris_be         1.0 4057068\n")),(0,a.yg)("ol",{start:4},(0,a.yg)("li",{parentName:"ol"},"\u540c\u65f6\u5ba2\u6237\u7aef\u4f1a\u89c2\u5bdf\u5230\u5927\u91cf\u7531\u4e8e\u5185\u5b58\u4e0d\u8db3\u5bfc\u81f4\u7684\u67e5\u8be2\u5931\u8d25\u3002")),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre"},'1724074250162,14126,1c_sql,HY000 1105,"java.sql.SQLException: errCode = 2, detailMessage = (127.0.0.1)[MEM_LIMIT_EXCEEDED]GC wg for hard limit, wg id:11201, name:g2, used:1.71 GB, limit:1.69 GB, backend:10.16.10.8. cancel top memory used tracker <Query#Id=4a0689936c444ac8-a0d01a50b944f6e7> consumption 1.71 GB. details:process memory used 3.01 GB exceed soft limit 304.41 GB or sys available memory 101.16 GB less than warning water mark 12.80 GB., Execute again after enough memory, details see be.INFO.",\u5e76\u53d1 1-3,text,false,,444,0,3,3,null,0,0,0\n')),(0,a.yg)("p",null,"\u8fd9\u4e2a\u62a5\u9519\u4fe1\u606f\u4e2d\u53ef\u4ee5\u770b\u5230\uff0cWorkload Group\u4f7f\u7528\u4e861.7G\u7684\u5185\u5b58\uff0c\u4f46\u662fWorkload Group\u7684\u9650\u5236\u662f1.69G\uff0c\u8fd9\u91cc\u7684\u8ba1\u7b97\u65b9\u5f0f\u662f\u8fd9\u6837\u76841.69G = \u7269\u7406\u673a\u5185\u5b58(375) ",(0,a.yg)("em",{parentName:"p"}," mem_limit(be.conf\u4e2d\u7684\u503c\uff0c\u9ed8\u8ba4\u4e3a0.9) ")," 0.5%\uff08Workload Group\u7684\u914d\u7f6e\uff09\n\u4e5f\u5c31\u662f\u8bf4\uff0cWorkload Group\u4e2d\u914d\u7f6e\u7684\u5185\u5b58\u767e\u5206\u6bd4\u662f\u57fa\u4e8eDoris\u8fdb\u7a0b\u53ef\u7528\u5185\u5b58\u518d\u6b21\u8fdb\u884c\u8ba1\u7b97\u7684\u3002"),(0,a.yg)("h2",{id:"\u4f7f\u7528\u5efa\u8bae"},"\u4f7f\u7528\u5efa\u8bae"),(0,a.yg)("p",null,"\u5982\u4e0a\u6587\u6d4b\u8bd5\uff0c\u786c\u9650\u53ef\u4ee5\u63a7\u5236Workload Group\u7684\u5185\u5b58\u4f7f\u7528\uff0c\u4f46\u5374\u662f\u901a\u8fc7\u6740\u6b7b\u67e5\u8be2\u7684\u65b9\u5f0f\u91ca\u653e\u5185\u5b58\uff0c\u8fd9\u5bf9\u7528\u6237\u6765\u8bf4\u4f53\u9a8c\u4f1a\u975e\u5e38\u4e0d\u53cb\u597d\uff0c\u6781\u7aef\u60c5\u51b5\u4e0b\u53ef\u80fd\u4f1a\u5bfc\u81f4\u6240\u6709\u67e5\u8be2\u90fd\u5931\u8d25\u3002\n\u56e0\u6b64\u5728\u751f\u4ea7\u73af\u5883\u4e2d\u63a8\u8350\u5185\u5b58\u786c\u9650\u914d\u5408\u67e5\u8be2\u6392\u961f\u7684\u529f\u80fd\u4e00\u8d77\u4f7f\u7528\uff0c\u53ef\u4ee5\u5728\u9650\u5236\u5185\u5b58\u4f7f\u7528\u7684\u540c\u65f6\u4fdd\u8bc1\u67e5\u8be2\u7684\u6210\u529f\u7387\u3002"))}p.isMDXComponent=!0}}]);