"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([[467463],{15680:(e,n,a)=>{a.d(n,{xA:()=>o,yg:()=>u});var t=a(296540);function l(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function r(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),a.push.apply(a,t)}return a}function p(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?r(Object(a),!0).forEach((function(n){l(e,n,a[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))}))}return e}function i(e,n){if(null==e)return{};var a,t,l=function(e,n){if(null==e)return{};var a,t,l={},r=Object.keys(e);for(t=0;t<r.length;t++)a=r[t],n.indexOf(a)>=0||(l[a]=e[a]);return l}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(t=0;t<r.length;t++)a=r[t],n.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(l[a]=e[a])}return l}var y=t.createContext({}),g=function(e){var n=t.useContext(y),a=n;return e&&(a="function"==typeof e?e(n):p(p({},n),e)),a},o=function(e){var n=g(e.components);return t.createElement(y.Provider,{value:n},e.children)},m="mdxType",E={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},N=t.forwardRef((function(e,n){var a=e.components,l=e.mdxType,r=e.originalType,y=e.parentName,o=i(e,["components","mdxType","originalType","parentName"]),m=g(a),N=l,u=m["".concat(y,".").concat(N)]||m[N]||E[N]||r;return a?t.createElement(u,p(p({ref:n},o),{},{components:a})):t.createElement(u,p({ref:n},o))}));function u(e,n){var a=arguments,l=n&&n.mdxType;if("string"==typeof e||l){var r=a.length,p=new Array(r);p[0]=N;var i={};for(var y in n)hasOwnProperty.call(n,y)&&(i[y]=n[y]);i.originalType=e,i[m]="string"==typeof e?e:l,p[1]=i;for(var g=2;g<r;g++)p[g]=a[g];return t.createElement.apply(null,p)}return t.createElement.apply(null,a)}N.displayName="MDXCreateElement"},100708:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>y,contentTitle:()=>p,default:()=>E,frontMatter:()=>r,metadata:()=>i,toc:()=>g});var t=a(58168),l=(a(296540),a(15680));const r={title:"\u539f\u7406\u4ecb\u7ecd",language:"zh-CN"},p=void 0,i={unversionedId:"query-acceleration/materialized-view/async-materialized-view/overview",id:"version-3.0/query-acceleration/materialized-view/async-materialized-view/overview",title:"\u539f\u7406\u4ecb\u7ecd",description:"\x3c!--",source:"@site/i18n/zh-CN/docusaurus-plugin-content-docs/version-3.0/query-acceleration/materialized-view/async-materialized-view/overview.md",sourceDirName:"query-acceleration/materialized-view/async-materialized-view",slug:"/query-acceleration/materialized-view/async-materialized-view/overview",permalink:"/zh-CN/docs/3.0/query-acceleration/materialized-view/async-materialized-view/overview",draft:!1,tags:[],version:"3.0",frontMatter:{title:"\u539f\u7406\u4ecb\u7ecd",language:"zh-CN"},sidebar:"docs",previous:{title:"\u540c\u6b65\u7269\u5316\u89c6\u56fe",permalink:"/zh-CN/docs/3.0/query-acceleration/materialized-view/sync-materialized-view"},next:{title:"\u529f\u80fd\u63cf\u8ff0",permalink:"/zh-CN/docs/3.0/query-acceleration/materialized-view/async-materialized-view/functions-and-demands"}},y={},g=[{value:"\u5f02\u6b65\u7269\u5316\u89c6\u56fe\u6784\u5efa",id:"\u5f02\u6b65\u7269\u5316\u89c6\u56fe\u6784\u5efa",level:2},{value:"\u81ea\u5b9a\u4e49\u5206\u533a",id:"\u81ea\u5b9a\u4e49\u5206\u533a",level:3},{value:"\u4f9d\u8d56\u57fa\u8868\u8fdb\u884c\u5206\u533a",id:"\u4f9d\u8d56\u57fa\u8868\u8fdb\u884c\u5206\u533a",level:3},{value:"\u5f02\u6b65\u7269\u5316\u89c6\u56fe\u5237\u65b0",id:"\u5f02\u6b65\u7269\u5316\u89c6\u56fe\u5237\u65b0",level:2},{value:"\u624b\u52a8\u89e6\u53d1",id:"\u624b\u52a8\u89e6\u53d1",level:3},{value:"\u5b9a\u65f6\u89e6\u53d1",id:"\u5b9a\u65f6\u89e6\u53d1",level:3},{value:"\u81ea\u52a8\u89e6\u53d1",id:"\u81ea\u52a8\u89e6\u53d1",level:3},{value:"\u900f\u660e\u6539\u5199\u80fd\u529b",id:"\u900f\u660e\u6539\u5199\u80fd\u529b",level:2},{value:"\u6d41\u7a0b\u56fe",id:"\u6d41\u7a0b\u56fe",level:3},{value:"\u57fa\u4e8e\u7ed3\u6784\u4fe1\u606f\u900f\u660e\u6539\u5199",id:"\u57fa\u4e8e\u7ed3\u6784\u4fe1\u606f\u900f\u660e\u6539\u5199",level:3}],o={toc:g},m="wrapper";function E(e){let{components:n,...r}=e;return(0,l.yg)(m,(0,t.A)({},o,r,{components:n,mdxType:"MDXLayout"}),(0,l.yg)("h2",{id:"\u5f02\u6b65\u7269\u5316\u89c6\u56fe\u6784\u5efa"},"\u5f02\u6b65\u7269\u5316\u89c6\u56fe\u6784\u5efa"),(0,l.yg)("p",null,"\u7269\u5316\u89c6\u56fe\u521b\u5efa\u5206\u533a\u6709\u4e24\u79cd\u65b9\u5f0f\uff1a\u81ea\u5b9a\u4e49\u5206\u533a\u548c\u4f9d\u8d56\u57fa\u8868\u7684\u5206\u533a\u81ea\u52a8\u521b\u5efa\u5206\u533a"),(0,l.yg)("h3",{id:"\u81ea\u5b9a\u4e49\u5206\u533a"},"\u81ea\u5b9a\u4e49\u5206\u533a"),(0,l.yg)("p",null,"\u521b\u5efa\u7269\u5316\u89c6\u56fe\u65f6\uff0c\u5982\u679c\u4e0d\u6307\u5b9a\u5206\u533a\u4fe1\u606f\uff0c\u7269\u5316\u89c6\u56fe\u5c06\u9ed8\u8ba4\u521b\u5efa\u4e00\u4e2a\u5206\u533a\uff0c\u6240\u6709\u6570\u636e\u90fd\u5b58\u653e\u5728\u8fd9\u4e2a\u5206\u533a\u4e2d\u3002"),(0,l.yg)("h3",{id:"\u4f9d\u8d56\u57fa\u8868\u8fdb\u884c\u5206\u533a"},"\u4f9d\u8d56\u57fa\u8868\u8fdb\u884c\u5206\u533a"),(0,l.yg)("p",null,"\u7269\u5316\u89c6\u56fe\u53ef\u4ee5\u901a\u8fc7\u591a\u4e2a\u57fa\u8868 JOIN \u5173\u8054\u521b\u5efa\uff0c\u5e76\u53ef\u4ee5\u9009\u62e9\u8ffd\u968f\u5176\u4e2d\u4e00\u4e2a\u57fa\u8868\u8fdb\u884c\u5206\u533a\uff08\u5efa\u8bae\u9009\u62e9\u4e8b\u5b9e\u8868\uff09\u3002"),(0,l.yg)("p",null,"\u4f8b\u5982\uff0c\u57fa\u8868",(0,l.yg)("inlineCode",{parentName:"p"},"t1"),"\u548c",(0,l.yg)("inlineCode",{parentName:"p"},"t2"),"\u7684\u5efa\u8868\u8bed\u53e5\u5206\u522b\u5982\u4e0b\uff1a"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-sql"},"CREATE TABLE `t1` (\n  `user_id` LARGEINT NOT NULL,\n  `o_date` DATE NOT NULL,\n  `num` SMALLINT NOT NULL\n) ENGINE=OLAP\nCOMMENT 'OLAP'\nPARTITION BY RANGE(`o_date`)\n(\nPARTITION p20170101 VALUES [('2017-01-01'), ('2017-01-02')),\nPARTITION p20170102 VALUES [('2017-01-02'), ('2017-01-03')),\nPARTITION p20170201 VALUES [('2017-02-01'), ('2017-02-02'))\n)\nDISTRIBUTED BY HASH(`user_id`) BUCKETS 2\nPROPERTIES ('replication_num' = '1') ;\nCREATE TABLE `t2` (\n  `user_id` LARGEINT NOT NULL,\n  `age` SMALLINT NOT NULL\n) ENGINE=OLAP\nPARTITION BY LIST(`age`)\n(\n    PARTITION `p1` VALUES IN ('1'),\n    PARTITION `p2` VALUES IN ('2')\n)\nDISTRIBUTED BY HASH(`user_id`) BUCKETS 2\nPROPERTIES ('replication_num' = '1') ;\n")),(0,l.yg)("p",null,"\u82e5\u7269\u5316\u89c6\u56fe\u7684\u5efa\u8868\u8bed\u53e5\u5982\u4e0b\uff1a"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-sql"},"CREATE MATERIALIZED VIEW mv1\nBUILD DEFERRED REFRESH AUTO ON MANUAL\npartition by(`order_date`)\nDISTRIBUTED BY RANDOM BUCKETS 2\nPROPERTIES (\n'replication_num' = '1'\n)\nAS\nSELECT t1.o_date as order_date, t1.user_id as user_id, t1.num, t2.age FROM t1 join t2 on t1.user_id=t2.user_id;\n")),(0,l.yg)("p",null,"\u90a3\u4e48\u7269\u5316\u89c6\u56fe",(0,l.yg)("inlineCode",{parentName:"p"},"mv1"),"\u5c06\u548c",(0,l.yg)("inlineCode",{parentName:"p"},"t1"),"\u4e00\u6837\uff0c\u6709\u4e09\u4e2a\u5206\u533a\uff1a"),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("p",{parentName:"li"},(0,l.yg)("inlineCode",{parentName:"p"},"[('2017-01-01'), ('2017-01-02'))"))),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("p",{parentName:"li"},(0,l.yg)("inlineCode",{parentName:"p"},"[('2017-01-02'), ('2017-01-03'))"))),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("p",{parentName:"li"},(0,l.yg)("inlineCode",{parentName:"p"},"[('2017-02-01'), ('2017-02-02'))")))),(0,l.yg)("p",null,"\u82e5\u7269\u5316\u89c6\u56fe\u7684\u5efa\u8868\u8bed\u53e5\u5982\u4e0b\uff1a"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-sql"},"CREATE MATERIALIZED VIEW mv2\nBUILD DEFERRED REFRESH AUTO ON MANUAL\npartition by(`age`)\nDISTRIBUTED BY RANDOM BUCKETS 2\nPROPERTIES (\n'replication_num' = '1'\n)\nAS\nSELECT t1.o_date as order_date, t1.user_id as user_id, t1.num, t2.age FROM t1 join t2 on t1.user_id=t2.user_id;\n")),(0,l.yg)("p",null,"\u90a3\u4e48\u7269\u5316\u89c6\u56fe",(0,l.yg)("inlineCode",{parentName:"p"},"mv2"),"\u5c06\u548c",(0,l.yg)("inlineCode",{parentName:"p"},"t2"),"\u4e00\u6837\uff0c\u6709\u4e24\u4e2a\u5206\u533a\uff1a"),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("p",{parentName:"li"},(0,l.yg)("inlineCode",{parentName:"p"},"('1')"))),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("p",{parentName:"li"},(0,l.yg)("inlineCode",{parentName:"p"},"('2')")))),(0,l.yg)("p",null,"\u5728\u4f9d\u8d56\u57fa\u8868\u5206\u533a\u521b\u5efa\u7269\u5316\u89c6\u56fe\u65f6\uff0c\u4e0d\u540c\u573a\u666f\u9700\u8981\u5408\u7406\u8bbe\u8ba1\u4e0d\u540c\u7684\u5206\u533a\u7b56\u7565\uff0c\u4e0b\u9762\u5c06\u4e3e\u4f8b\u8bf4\u660e\u591a\u5217\u5206\u533a\u3001\u90e8\u5206\u5206\u533a\u4e0e\u5206\u533a\u4e0a\u5377\u4e09\u79cd\u60c5\u51b5\u3002"),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"1. \u57fa\u8868\u6709\u591a\u5217\u5206\u533a")),(0,l.yg)("admonition",{title:"\u63d0\u793a",type:"tip"},(0,l.yg)("p",{parentName:"admonition"},"\u81ea Doris 2.1.0 \u7248\u672c\u8d77\u652f\u6301\u591a\u5217\u5206\u533a")),(0,l.yg)("p",null,"\u76ee\u524d\u4ec5\u652f\u6301 Hive \u5916\u8868\u6709\u591a\u5217\u5206\u533a\u3002Hive \u5916\u8868\u6709\u5f88\u591a\u591a\u7ea7\u5206\u533a\u7684\u60c5\u51b5\uff0c\u4f8b\u5982\u4e00\u7ea7\u5206\u533a\u6309\u7167\u65e5\u671f\uff0c\u4e8c\u7ea7\u5206\u533a\u6309\u7167\u533a\u57df\u3002\u7269\u5316\u89c6\u56fe\u53ef\u4ee5\u9009\u62e9 Hive \u7684\u67d0\u4e00\u7ea7\u5206\u533a\u5217\u4f5c\u4e3a\u7269\u5316\u89c6\u56fe\u7684\u5206\u533a\u5217\u3002"),(0,l.yg)("p",null,"\u4f8b\u5982\uff0cHive \u7684\u5efa\u8868\u8bed\u53e5\u5982\u4e0b\uff1a"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-sql"},'CREATE TABLE hive1 (\n`k1` int)\nPARTITIONED BY (\n`year` int,\n`region` string)\nSTORED AS ORC;\n\nalter table hive1 add if not exists\npartition(year=2020,region="bj")\npartition(year=2020,region="sh")\npartition(year=2021,region="bj")\npartition(year=2021,region="sh")\npartition(year=2022,region="bj")\npartition(year=2022,region="sh")\n')),(0,l.yg)("p",null,"\u5f53\u7269\u5316\u89c6\u56fe\u7684\u521b\u5efa\u8bed\u53e5\u5982\u4e0b\u65f6\uff0c\u7269\u5316\u89c6\u56fe",(0,l.yg)("inlineCode",{parentName:"p"},"mv_hive"),"\u5c06\u6709\u4e09\u4e2a\u5206\u533a\uff1a",(0,l.yg)("inlineCode",{parentName:"p"},"('2020')\uff0c('2021')\uff0c('2022')")),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-sql"},"CREATE MATERIALIZED VIEW mv_hive\nBUILD DEFERRED REFRESH AUTO ON MANUAL\npartition by(`year`)\nDISTRIBUTED BY RANDOM BUCKETS 2\nPROPERTIES ('replication_num' = '1')\nAS\nSELECT k1,year,region FROM hive1;\n")),(0,l.yg)("p",null,"\u5f53\u7269\u5316\u89c6\u56fe\u7684\u5efa\u8868\u8bed\u53e5\u5982\u4e0b\u65f6\uff0c\u90a3\u4e48\u7269\u5316\u89c6\u56fe",(0,l.yg)("inlineCode",{parentName:"p"},"mv_hive2"),"\u5c06\u6709\u5982\u4e0b\u4e24\u4e2a\u5206\u533a\uff1a",(0,l.yg)("inlineCode",{parentName:"p"},"('bj')"),"\uff0c",(0,l.yg)("inlineCode",{parentName:"p"},"('sh')"),"\uff1a"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-sql"},"CREATE MATERIALIZED VIEW mv_hive2\nBUILD DEFERRED REFRESH AUTO ON MANUAL\npartition by(`region`)\nDISTRIBUTED BY RANDOM BUCKETS 2\nPROPERTIES ('replication_num' = '1')\nAS\nSELECT k1,year,region FROM hive1;\n")),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"2. \u4ec5\u4f7f\u7528\u57fa\u8868\u90e8\u5206\u5206\u533a")),(0,l.yg)("admonition",{title:"\u63d0\u793a",type:"tip"},(0,l.yg)("p",{parentName:"admonition"},"\u81ea Doris 2.1.1 \u7248\u672c\u8d77\u652f\u6301\u6b64\u529f\u80fd")),(0,l.yg)("p",null,"\u6709\u4e9b\u57fa\u8868\u6709\u5f88\u591a\u5206\u533a\uff0c\u4f46\u662f\u7269\u5316\u89c6\u56fe\u53ea\u5173\u6ce8\u6700\u8fd1\u4e00\u6bb5\u65f6\u95f4\u7684\u201c\u70ed\u201d\u6570\u636e\uff0c\u90a3\u4e48\u53ef\u4ee5\u4f7f\u7528\u6b64\u529f\u80fd\u3002"),(0,l.yg)("p",null,"\u57fa\u8868\u7684\u5efa\u8868\u8bed\u53e5\u5982\u4e0b\uff1a"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-sql"},'CREATE TABLE t1 (\n    `k1` INT,\n    `k2` DATE NOT NULL\n) ENGINE=OLAP\nDUPLICATE KEY(`k1`)\nCOMMENT \'OLAP\'\nPARTITION BY range(`k2`)\n(\nPARTITION p26 VALUES [("2024-03-26"),("2024-03-27")),\nPARTITION p27 VALUES [("2024-03-27"),("2024-03-28")),\nPARTITION p28 VALUES [("2024-03-28"),("2024-03-29"))\n)\nDISTRIBUTED BY HASH(`k1`) BUCKETS 2\nPROPERTIES (\n\'replication_num\' = \'1\'\n);\n')),(0,l.yg)("p",null,"\u7269\u5316\u89c6\u56fe\u7684\u521b\u5efa\u8bed\u53e5\u5982\u4ee5\u4e0b\u4e3e\u4f8b\uff0c\u4ee3\u8868\u7269\u5316\u89c6\u56fe\u53ea\u5173\u6ce8\u6700\u8fd1\u4e00\u5929\u7684\u6570\u636e\u3002\u82e5\u5f53\u524d\u65f6\u95f4\u4e3a 2024-03-28 xx:xx:xx\uff0c\u8fd9\u6837\u7269\u5316\u89c6\u56fe\u4f1a\u4ec5\u6709\u4e00\u4e2a\u5206\u533a ",(0,l.yg)("inlineCode",{parentName:"p"},'[("2024-03-28"),("2024-03-29")]'),"\uff1a"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-sql"},"CREATE MATERIALIZED VIEW mv1\nBUILD DEFERRED REFRESH AUTO ON MANUAL\npartition by(`k2`)\nDISTRIBUTED BY RANDOM BUCKETS 2\nPROPERTIES (\n'replication_num' = '1',\n'partition_sync_limit'='1',\n'partition_sync_time_unit'='DAY'\n)\nAS\nSELECT * FROM t1;\n")),(0,l.yg)("p",null,"\u82e5\u65f6\u95f4\u53c8\u8fc7\u4e86\u4e00\u5929\uff0c\u5f53\u524d\u65f6\u95f4\u4e3a",(0,l.yg)("inlineCode",{parentName:"p"}," 2024-03-29 xx:xx:xx"),"\uff0c",(0,l.yg)("inlineCode",{parentName:"p"},"t1"),"\u5219\u4f1a\u65b0\u589e\u4e00\u4e2a\u5206\u533a ",(0,l.yg)("inlineCode",{parentName:"p"},'[("2024-03-29"),("2024-03-30")]'),"\uff0c\u82e5\u6b64\u65f6\u5237\u65b0\u7269\u5316\u89c6\u56fe\uff0c\u5237\u65b0\u5b8c\u6210\u540e\uff0c\u7269\u5316\u89c6\u56fe\u4f1a\u4ec5\u6709\u4e00\u4e2a\u5206\u533a ",(0,l.yg)("inlineCode",{parentName:"p"},'[("2024-03-29"),("2024-03-30")]'),"\u3002"),(0,l.yg)("p",null,"\u6b64\u5916\uff0c\u5206\u533a\u5b57\u6bb5\u662f\u5b57\u7b26\u4e32\u7c7b\u578b\u65f6\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u7269\u5316\u89c6\u56fe\u5c5e\u6027 ",(0,l.yg)("inlineCode",{parentName:"p"},"partition_date_format"),"\uff0c\u4f8b\u5982 ",(0,l.yg)("inlineCode",{parentName:"p"},"%Y-%m-%d")," \u3002"),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"3. \u5206\u533a\u4e0a\u5377")),(0,l.yg)("admonition",{title:"\u63d0\u793a",type:"tip"},(0,l.yg)("p",{parentName:"admonition"},"\u81ea Doris 2.1.5 \u7248\u672c\u8d77\u652f\u6301\u6b64\u529f\u80fd")),(0,l.yg)("p",null,"\u5f53\u57fa\u8868\u6570\u636e\u7ecf\u8fc7\u805a\u5408\u5904\u7406\u540e\uff0c\u5404\u5206\u533a\u7684\u6570\u636e\u91cf\u53ef\u80fd\u4f1a\u663e\u8457\u51cf\u5c11\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u91c7\u7528\u5206\u533a\u4e0a\u5377\u7b56\u7565\uff0c\u4ee5\u964d\u4f4e\u7269\u5316\u89c6\u56fe\u7684\u5206\u533a\u6570\u91cf\u3002"),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("p",{parentName:"li"},"List \u5206\u533a"),(0,l.yg)("p",{parentName:"li"},"  \u9700\u8981\u6ce8\u610f\u7684\u662f\uff0cHive \u4e2d\u7684\u5206\u533a\u5bf9\u5e94\u4e8e Doris \u4e2d\u7684 list \u5206\u533a\u3002"),(0,l.yg)("p",{parentName:"li"},"  \u5047\u8bbe\u57fa\u8868\u7684\u5efa\u8868\u8bed\u53e5\u5982\u4e0b\uff1a"),(0,l.yg)("pre",{parentName:"li"},(0,l.yg)("code",{parentName:"pre",className:"language-sql"},"CREATE TABLE `t1` (\n`k1` INT NOT NULL,\n`k2` DATE NOT NULL\n) ENGINE=OLAP\nDUPLICATE KEY(`k1`)\nCOMMENT 'OLAP'\nPARTITION BY list(`k2`)\n(\nPARTITION p_20200101 VALUES IN (\"2020-01-01\"),\nPARTITION p_20200102 VALUES IN (\"2020-01-02\"),\nPARTITION p_20200201 VALUES IN (\"2020-02-01\")\n)\nDISTRIBUTED BY HASH(`k1`) BUCKETS 2\nPROPERTIES ('replication_num' = '1') ;\n")),(0,l.yg)("p",{parentName:"li"},"  \u82e5\u7269\u5316\u89c6\u56fe\u7684\u521b\u5efa\u8bed\u53e5\u5982\u4e0b\uff0c\u5219\u8be5\u7269\u5316\u89c6\u56fe\u5c06\u5305\u542b\u4e24\u4e2a\u5206\u533a\uff1a",(0,l.yg)("inlineCode",{parentName:"p"},'("2020-01-01","2020-01-02")')," \u548c ",(0,l.yg)("inlineCode",{parentName:"p"},'("2020-02-01")')),(0,l.yg)("pre",{parentName:"li"},(0,l.yg)("code",{parentName:"pre",className:"language-sql"},"CREATE MATERIALIZED VIEW mv1\n    BUILD DEFERRED REFRESH AUTO ON MANUAL\n    partition by (date_trunc(`k2`,'month'))\n    DISTRIBUTED BY RANDOM BUCKETS 2\n    PROPERTIES (\n    'replication_num' = '1'\n    )\n    AS\n    SELECT * FROM t1;\n")),(0,l.yg)("p",{parentName:"li"},"  \u82e5\u7269\u5316\u89c6\u56fe\u7684\u521b\u5efa\u8bed\u53e5\u5982\u4e0b\uff0c\u5219\u8be5\u7269\u5316\u89c6\u56fe\u5c06\u53ea\u5305\u542b\u4e00\u4e2a\u5206\u533a\uff1a",(0,l.yg)("inlineCode",{parentName:"p"},'("2020-01-01","2020-01-02","2020-02-01")')),(0,l.yg)("pre",{parentName:"li"},(0,l.yg)("code",{parentName:"pre",className:"language-sql"},"CREATE MATERIALIZED VIEW mv1\n    BUILD DEFERRED REFRESH AUTO ON MANUAL\n    partition by (date_trunc(`k2`,'year'))\n    DISTRIBUTED BY RANDOM BUCKETS 2\n    PROPERTIES (\n    'replication_num' = '1'\n    )\n    AS\n    SELECT * FROM t1;\n"))),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("p",{parentName:"li"},"Range \u5206\u533a"),(0,l.yg)("p",{parentName:"li"},"  \u5047\u8bbe\u57fa\u8868\u7684\u5efa\u8868\u8bed\u53e5\u5982\u4e0b\uff1a"),(0,l.yg)("pre",{parentName:"li"},(0,l.yg)("code",{parentName:"pre",className:"language-sql"},'CREATE TABLE `t1` (\n`k1` LARGEINT NOT NULL,\n`k2` DATE NOT NULL\n) ENGINE=OLAP\nDUPLICATE KEY(`k1`)\nCOMMENT \'OLAP\'\nPARTITION BY range(`k2`)\n(\nPARTITION p_20200101 VALUES [("2020-01-01"),("2020-01-02")),\nPARTITION p_20200102 VALUES [("2020-01-02"),("2020-01-03")),\nPARTITION p_20200201 VALUES [("2020-02-01"),("2020-02-02"))\n)\nDISTRIBUTED BY HASH(`k1`) BUCKETS 2\nPROPERTIES (\'replication_num\' = \'1\') ;\n')),(0,l.yg)("p",{parentName:"li"},"  \u82e5\u7269\u5316\u89c6\u56fe\u7684\u521b\u5efa\u8bed\u53e5\u5982\u4e0b\uff0c\u5219\u8be5\u7269\u5316\u89c6\u56fe\u5c06\u5305\u542b\u4e24\u4e2a\u5206\u533a\uff1a",(0,l.yg)("inlineCode",{parentName:"p"},'[("2020-01-01","2020-02-01")] '),"\u548c",(0,l.yg)("inlineCode",{parentName:"p"},' [("2020-02-01","2020-03-01")]')),(0,l.yg)("pre",{parentName:"li"},(0,l.yg)("code",{parentName:"pre",className:"language-sql"},"CREATE MATERIALIZED VIEW mv1\n    BUILD DEFERRED REFRESH AUTO ON MANUAL\n    partition by (date_trunc(`k2`,'month'))\n    DISTRIBUTED BY RANDOM BUCKETS 2\n    PROPERTIES (\n    'replication_num' = '1'\n    )\n    AS\n    SELECT * FROM t1;\n")),(0,l.yg)("p",{parentName:"li"},"  \u82e5\u7269\u5316\u89c6\u56fe\u7684\u521b\u5efa\u8bed\u53e5\u5982\u4e0b\uff0c\u5219\u8be5\u7269\u5316\u89c6\u56fe\u5c06\u53ea\u5305\u542b\u4e00\u4e2a\u5206\u533a\uff1a",(0,l.yg)("inlineCode",{parentName:"p"},'[("2020-01-01","2021-01-01")]')),(0,l.yg)("pre",{parentName:"li"},(0,l.yg)("code",{parentName:"pre",className:"language-sql"},"CREATE MATERIALIZED VIEW mv1\n    BUILD DEFERRED REFRESH AUTO ON MANUAL\n    partition by (date_trunc(`k2`,'year'))\n    DISTRIBUTED BY RANDOM BUCKETS 2\n    PROPERTIES (\n    'replication_num' = '1'\n    )\n    AS\n    SELECT * FROM t1;\n")),(0,l.yg)("p",{parentName:"li"},"  \u6b64\u5916\uff0c\u5982\u679c\u5206\u533a\u5b57\u6bb5\u4e3a\u5b57\u7b26\u4e32\u7c7b\u578b\uff0c\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6e\u7269\u5316\u89c6\u56fe\u7684 ",(0,l.yg)("inlineCode",{parentName:"p"},"partition_date_format")," \u5c5e\u6027\u6765\u6307\u5b9a\u65e5\u671f\u683c\u5f0f\uff0c\u4f8b\u5982 ",(0,l.yg)("inlineCode",{parentName:"p"},"'%Y-%m-%d'"),"\u3002"))),(0,l.yg)("h2",{id:"\u5f02\u6b65\u7269\u5316\u89c6\u56fe\u5237\u65b0"},"\u5f02\u6b65\u7269\u5316\u89c6\u56fe\u5237\u65b0"),(0,l.yg)("p",null,"\u7269\u5316\u89c6\u56fe\u662f\u6309\u7167\u5206\u533a\u4e3a\u5355\u4f4d\u8fdb\u884c\u5237\u65b0\u7684\u3002\u5982\u679c\u7269\u5316\u89c6\u56fe\u6ca1\u6709\u6307\u5b9a\u5206\u533a\uff0c\u90a3\u4e48\u6bcf\u6b21\u90fd\u5237\u65b0\u7269\u5316\u89c6\u56fe\u7684\u9ed8\u8ba4\u5206\u533a\uff0c\u5373\u5237\u65b0\u7269\u5316\u89c6\u56fe\u7684\u5168\u90e8\u6570\u636e\u3002"),(0,l.yg)("p",null,"\u7269\u5316\u89c6\u56fe\u6709\u4e09\u79cd\u89e6\u53d1\u5237\u65b0\u673a\u5236\uff1a"),(0,l.yg)("h3",{id:"\u624b\u52a8\u89e6\u53d1"},"\u624b\u52a8\u89e6\u53d1"),(0,l.yg)("p",null,"\u7528\u6237\u901a\u8fc7 SQL \u8bed\u53e5\u89e6\u53d1\u7269\u5316\u89c6\u56fe\u7684\u5237\u65b0\uff0c\u76ee\u524d\u6709\u4e09\u79cd\u7b56\u7565\uff1a"),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("p",{parentName:"li"},"\u4e0d\u5173\u5fc3\u5177\u4f53\u5237\u65b0\u54ea\u4e9b\u5206\u533a\uff0c\u8981\u6c42\u5237\u65b0\u5b8c\u6210\u540e\uff0c\u7269\u5316\u89c6\u56fe\u7684\u6570\u636e\u548c\u57fa\u8868\u4fdd\u6301\u540c\u6b65\u3002"),(0,l.yg)("pre",{parentName:"li"},(0,l.yg)("code",{parentName:"pre",className:"language-sql"},"REFRESH MATERIALIZED VIEW mvName AUTO;\n"))),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("p",{parentName:"li"},"\u4e0d\u7ba1\u7269\u5316\u89c6\u56fe\u73b0\u5b58\u54ea\u4e9b\u6570\u636e\uff0c\u5237\u65b0\u7269\u5316\u89c6\u56fe\u7684\u6240\u6709\u5206\u533a\u3002"),(0,l.yg)("pre",{parentName:"li"},(0,l.yg)("code",{parentName:"pre",className:"language-sql"},"REFRESH MATERIALIZED VIEW mvName COMPLETE;\n"))),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("p",{parentName:"li"},"\u4e0d\u7ba1\u7269\u5316\u89c6\u56fe\u73b0\u5b58\u54ea\u4e9b\u6570\u636e\uff0c\u53ea\u5237\u65b0\u6307\u5b9a\u7684\u5206\u533a\u3002"),(0,l.yg)("pre",{parentName:"li"},(0,l.yg)("code",{parentName:"pre",className:"language-sql"},"REFRESH MATERIALIZED VIEW mvName partitions(partitionName1,partitionName2);\n")))),(0,l.yg)("admonition",{title:"\u63d0\u793a ",type:"tip"},(0,l.yg)("p",{parentName:"admonition"},(0,l.yg)("inlineCode",{parentName:"p"},"partitionName")," \u53ef\u4ee5\u901a\u8fc7 ",(0,l.yg)("inlineCode",{parentName:"p"},"SHOW PARTITIONS FROM mvName")," \u83b7\u53d6\u3002")),(0,l.yg)("h3",{id:"\u5b9a\u65f6\u89e6\u53d1"},"\u5b9a\u65f6\u89e6\u53d1"),(0,l.yg)("p",null,"\u901a\u8fc7\u7269\u5316\u89c6\u56fe\u7684\u521b\u5efa\u8bed\u53e5\u6307\u5b9a\u95f4\u9694\u591a\u4e45\u5237\u65b0\u4e00\u6b21\u6570\u636e"),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("p",{parentName:"li"},"\u5982\u679c\u7269\u5316\u89c6\u56fe\u7684\u521b\u5efa\u8bed\u53e5\u5982\u4e0b\uff0c\u8981\u6c42\u5168\u91cf\u5237\u65b0 (",(0,l.yg)("inlineCode",{parentName:"p"},"REFRESH COMPLETE"),")\uff0c\u90a3\u4e48\u7269\u5316\u89c6\u56fe\u6bcf 10 \u5c0f\u65f6\u5237\u65b0\u4e00\u6b21\uff0c\u5e76\u4e14\u5237\u65b0\u7269\u5316\u89c6\u56fe\u7684\u6240\u6709\u5206\u533a\u3002"),(0,l.yg)("pre",{parentName:"li"},(0,l.yg)("code",{parentName:"pre",className:"language-sql"},"CREATE MATERIALIZED VIEW mv1\nREFRESH COMPLETE ON SCHEDULE EVERY 10 hour\npartition by(`xxx`)\nAS\nselect ...;\n"))),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("p",{parentName:"li"},"\u5982\u679c\u7269\u5316\u89c6\u56fe\u7684\u521b\u5efa\u8bed\u53e5\u5982\u4e0b\uff0c\u8981\u6c42\u81ea\u52a8\u8ba1\u7b97\u9700\u8981\u5237\u65b0\u7684\u5206\u533a (",(0,l.yg)("inlineCode",{parentName:"p"},"REFRESH AUTO"),")\uff0c\u90a3\u4e48\u7269\u5316\u89c6\u56fe\u6bcf 10 \u5c0f\u65f6\u5237\u65b0\u4e00\u6b21\uff08\u4ece 2.1.3 \u7248\u672c\u5f00\u59cb\u80fd\u81ea\u52a8\u8ba1\u7b97 Hive \u9700\u8981\u5237\u65b0\u7684\u5206\u533a\uff09\u3002"),(0,l.yg)("pre",{parentName:"li"},(0,l.yg)("code",{parentName:"pre",className:"language-sql"},"CREATE MATERIALIZED VIEW mv1\nREFRESH AUTO ON SCHEDULE EVERY 10 hour\npartition by(`xxx`)\nAS\nselect ...;\n")))),(0,l.yg)("h3",{id:"\u81ea\u52a8\u89e6\u53d1"},"\u81ea\u52a8\u89e6\u53d1"),(0,l.yg)("admonition",{title:"\u63d0\u793a",type:"tip"},(0,l.yg)("p",{parentName:"admonition"},"\u81ea Apache Doris 2.1.4 \u7248\u672c\u8d77\u652f\u6301\u6b64\u529f\u80fd\u3002")),(0,l.yg)("p",null,"\u57fa\u8868\u6570\u636e\u53d1\u751f\u53d8\u66f4\u540e\uff0c\u81ea\u52a8\u89e6\u53d1\u76f8\u5173\u7269\u5316\u89c6\u56fe\u5237\u65b0\uff0c\u5237\u65b0\u7684\u5206\u533a\u8303\u56f4\u4e0e\u201c\u5b9a\u65f6\u89e6\u53d1\u201d\u4e00\u81f4\u3002"),(0,l.yg)("p",null,"\u5982\u679c\u7269\u5316\u89c6\u56fe\u7684\u521b\u5efa\u8bed\u53e5\u5982\u4e0b\uff0c\u90a3\u4e48\u5f53 ",(0,l.yg)("inlineCode",{parentName:"p"},"t1")," \u7684\u6570\u636e\u53d1\u751f\u53d8\u5316\u65f6\uff0c\u4f1a\u81ea\u52a8\u89e6\u53d1\u7269\u5316\u89c6\u56fe\u7684\u5237\u65b0\u3002"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-sql"},"CREATE MATERIALIZED VIEW mv1\nREFRESH ON COMMIT\npartition by(`xxx`)\nAS\nselect ... from t1;\n")),(0,l.yg)("h2",{id:"\u900f\u660e\u6539\u5199\u80fd\u529b"},"\u900f\u660e\u6539\u5199\u80fd\u529b"),(0,l.yg)("p",null,"Doris \u7684\u5f02\u6b65\u7269\u5316\u89c6\u56fe\u91c7\u7528\u4e86\u57fa\u4e8e SPJG\uff08SELECT-PROJECT-JOIN-GROUP-BY\uff09\u6a21\u5f0f\u7684\u7ed3\u6784\u4fe1\u606f\u6765\u8fdb\u884c\u900f\u660e\u6539\u5199\u7684\u7b97\u6cd5\u3002Doris \u80fd\u591f\u5206\u6790\u67e5\u8be2 SQL \u7684\u7ed3\u6784\u4fe1\u606f\uff0c\u81ea\u52a8\u5bfb\u627e\u6ee1\u8db3\u8981\u6c42\u7684\u7269\u5316\u89c6\u56fe\uff0c\u5e76\u5c1d\u8bd5\u8fdb\u884c\u900f\u660e\u6539\u5199\uff0c\u4f7f\u7528\u6700\u4f18\u7684\u7269\u5316\u89c6\u56fe\u6765\u8868\u8fbe\u67e5\u8be2 SQL\u3002"),(0,l.yg)("h3",{id:"\u6d41\u7a0b\u56fe"},"\u6d41\u7a0b\u56fe"),(0,l.yg)("p",null,(0,l.yg)("img",{alt:"\u900f\u660e\u6539\u5199\u80fd\u529b",src:a(945592).A,width:"1920",height:"3506"})),(0,l.yg)("h3",{id:"\u57fa\u4e8e\u7ed3\u6784\u4fe1\u606f\u900f\u660e\u6539\u5199"},"\u57fa\u4e8e\u7ed3\u6784\u4fe1\u606f\u900f\u660e\u6539\u5199"),(0,l.yg)("p",null,"\u5982\u4e0a\u8ff0\u6d41\u7a0b\u56fe\u6240\u793a\uff0c\u5728\u83b7\u53d6\u7269\u5316\u5bf9\u5e94\u7684\u67e5\u8be2\u7ed3\u6784\u540e\uff0c\u5c06\u57fa\u4e8e\u7ed3\u6784\u4fe1\u606f\u8fdb\u884c\u900f\u660e\u6539\u5199\u3002\u8fd9\u65f6\uff0c\u9700\u8981\u505a\u5982\u4e0b\u6821\u9a8c\uff1a"),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"1. \u6821\u9a8c\u7269\u5316\u89c6\u56fe\u662f\u5426\u5305\u542b\u67e5\u8be2\u6240\u9700\u7684\u6240\u6709\u884c")),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("p",{parentName:"li"},"\u5bf9\u4e8e\u67e5\u8be2\uff1a",(0,l.yg)("inlineCode",{parentName:"p"},"SELECT * FROM T1, T2, \u2026, Tm WHERE Wq"))),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("p",{parentName:"li"},"\u5bf9\u4e8e\u7269\u5316\u89c6\u56fe\uff1a",(0,l.yg)("inlineCode",{parentName:"p"},"SELECT * FROM T1, T2, \u2026, Tm WHERE Wv")))),(0,l.yg)("admonition",{title:"\u6ce8\u610f",type:"caution"},(0,l.yg)("p",{parentName:"admonition"},"\u67e5\u8be2\u7684\u6761\u4ef6\u8981\u5f3a\u4e8e\u6216\u7b49\u4e8e\u7269\u5316\u7684\u6761\u4ef6\u3002")),(0,l.yg)("p",null,"\u5176\u4e2d T1, T2 \u662f\u8868\u3001Wq \u4ee3\u8868\u67e5\u8be2\u7684 WHERE \u8fc7\u6ee4\u6761\u4ef6\u3001Wv \u4ee3\u8868\u7269\u5316\u89c6\u56fe WHERE \u8fc7\u6ee4\u6761\u4ef6\u3002\u8981\u6ee1\u8db3\u89c6\u56fe\u5305\u542b\u4e86\u67e5\u8be2\u6240\u9700\u8981\u7684\u6240\u6709\u884c\uff0c\u5c31\u8981\u6ee1\u8db3\u8fc7\u6ee4\u6761\u4ef6 Wq \u80fd\u591f\u63a8\u5bfc\u51fa Wv\uff0c\u5373 ",(0,l.yg)("inlineCode",{parentName:"p"},"Wq -> Wv"),"\uff08\u6bd4\u5982 ",(0,l.yg)("inlineCode",{parentName:"p"},"Wq > 20"),", ",(0,l.yg)("inlineCode",{parentName:"p"},"Wv > 10"),"\uff0cWq \u5c31\u80fd\u591f\u63a8\u5bfc\u51fa Wv\u3002\uff09"),(0,l.yg)("p",null,"\u5bf9\u4e8e\u8868\u8fbe\u5f0f W \u8fd8\u53ef\u4ee5\u7ec6\u5316\uff0c\u8fc7\u6ee4\u7684\u8868\u8fbe\u5f0f\u53ef\u4ee5\u62c6\u6210\u4e09\u90e8\u5206\uff1aPE \u2227 PR \u2227 PU\u3002"),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("p",{parentName:"li"},"PE \u4ee3\u8868\u76f8\u7b49\u7684\u8868\u8fbe\u5f0f\uff1b")),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("p",{parentName:"li"},"PR \u4ee3\u8868\u8303\u56f4\u8fc7\u6ee4\u7684\u8868\u8fbe\u5f0f\uff0c\u4f7f\u7528\u201c<\u201d, \u201c\u2264\u201d, \u201c=\u201d, \u201c\u2265\u201d, \u201c>\u201d\u8fde\u63a5\u7684\u64cd\u4f5c\u7b26\uff1b")),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("p",{parentName:"li"},"PU \u4ee3\u8868\u9664\u4e86\u524d\u9762\u8868\u8fbe\u5f0f\u7684\u5176\u4f59\u8865\u507f\u8868\u8fbe\u5f0f\u3002"))),(0,l.yg)("p",null,"\u56e0\u6b64\uff0c\u57fa\u4e8e ",(0,l.yg)("inlineCode",{parentName:"p"},"Wq -> Wv")," \u63a8\u5bfc\u51fa ",(0,l.yg)("inlineCode",{parentName:"p"},"(PEq \u2227 PRq \u2227 PUq \u2192 PEv \u2227 PRv \u2227 PUv)"),"\u3002\u5176\u4e2d q \u4ee3\u8868\u67e5\u8be2\uff0cv \u4ee3\u8868\u7269\u5316\u89c6\u56fe\u3002"),(0,l.yg)("p",null,"\u56e0\u4e3a A -> C\uff0c\u90a3\u4e48 AB -> C\uff0c\u4e0a\u9762\u7684\u8868\u8fbe\u5f0f\u53ef\u4ee5\u8fdb\u4e00\u6b65\u63a8\u5bfc\u5982\u4e0b\uff1a"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-Plain"},"(PEq\u2227 PRq\u2227PUq\u21d2 PEv )\u2227\n(PEq\u2227 PRq\u2227PUq\u21d2 PRv)\u2227\n(PEq\u2227 PRq\u2227PUq\u21d2 PUv)\n")),(0,l.yg)("p",null,"\u53ef\u4ee5\u8fdb\u4e00\u6b65\u7b80\u5316\u6210\uff1a"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-Plain"},"(PEq \u21d2 PEv ) (Equijoin subsumption test \u7b49\u503c\u6761\u4ef6\u6821\u9a8c)\n(PEq \u2227 PRq \u21d2 PRv) (Range subsumption test \u8303\u56f4\u6761\u4ef6\u6821\u9a8c)\n(PEq \u2227 PUq \u21d2 PUv ) (Residual subsumption test \u8865\u507f\u6761\u4ef6\u6821\u9a8c)\n")),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("p",{parentName:"li"},"\u7b49\u503c\u6761\u4ef6\u6821\u9a8c\uff1a\u603b\u4f53\u539f\u5219\u662f\u7269\u5316\u89c6\u56fe\u7684\u76f8\u7b49\u8868\u8fbe\u5f0f\u662f\u67e5\u8be2\u76f8\u7b49\u8868\u8fbe\u5f0f\u7684\u5b50\u96c6\u3002\u7b49\u4ef7\u8868\u8fbe\u5f0f\u5177\u6709\u4f20\u9012\u6027\uff0c\u4e5f\u5e94\u4fdd\u6301\u6b63\u786e\u6027\u3002")),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("p",{parentName:"li"},"\u89c6\u56fe\u7684\u8303\u56f4\u8868\u8fbe\u5f0f\u5e94\u5305\u542b\u67e5\u8be2\u7684\u8868\u8fbe\u5f0f\u3002\u4f8b\u5982\uff0cT=\u5e38\u91cf\u503c\uff0c\u53ef\u4ee5\u8f6c\u6362\u6210 T>= \u5e38\u91cf\u503c and T<= \u5e38\u91cf\u503c\u7684\u5f62\u5f0f\u3002")),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("p",{parentName:"li"},"\u91c7\u7528 Expression Equals \u7684\u65b9\u5f0f\uff0c\u6821\u9a8c\u7269\u5316\u89c6\u56fe\u4e2d\u51fa\u73b0\u7684\u8865\u507f\u8868\u8fbe\u5f0f\u662f\u5426\u662f\u67e5\u8be2\u8865\u507f\u8868\u8fbe\u5f0f\u7684\u5b50\u96c6\u3002"))),(0,l.yg)("p",null,"\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u5c06\u901a\u8fc7\u4e3e\u4f8b\u8fdb\u4e00\u6b65\u89e3\u91ca\u68c0\u9a8c\u6b65\u9aa4\uff1a"),(0,l.yg)("p",null,"\u7269\u5316\u89c6\u56fe\u7684\u5b9a\u4e49\uff1a"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-sql"},"Select l_orderkey, o_custkey, l_partkey,\nl_shipdate, o_orderdate,\nl_quantity*l_extendedprice as gross_revenue\nFrom dbo.lineitem, dbo.orders, dbo.part\nWhere l_orderkey = o_orderkey\nAnd l_partkey = p_partkey\nAnd p_partkey >= 150\nAnd o_custkey >= 50 and o_custkey <= 500\nAnd p_name like \u2018%abc%\u2019\n")),(0,l.yg)("p",null,"\u67e5\u8be2\u7684\u5b9a\u4e49\uff1a"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-sql"},"Select l_orderkey, o_custkey, l_partkey,\nl_quantity*l_extendedprice\nFrom lineitem, orders, part\nWhere l_orderkey = o_orderkey\nAnd l_partkey = p_partkey\nAnd l_partkey >= 150 and l_partkey <= 160\nAnd o_custkey = 123\nAnd o_orderdate = l_shipdate\nAnd p_name like \u2018%abc%\u2019\nAnd l_quantity*l_extendedprice > 100\n")),(0,l.yg)("p",null,"\u7b2c\u4e00\u6b65\uff1a\u8ba1\u7b97\u7b49\u4ef7\u7c7b"),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("p",{parentName:"li"},"\u89c6\u56fe\u7b49\u4ef7\u7c7b\uff1a",(0,l.yg)("inlineCode",{parentName:"p"},"{l_orderkey, o_orderkey},{l_partkey, p_partkey}, {o_orderdate}, {l_shipdate}"))),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("p",{parentName:"li"},"\u67e5\u8be2\u7b49\u4ef7\u7c7b\uff1a",(0,l.yg)("inlineCode",{parentName:"p"},"{l_orderkey, o_orderkey},{l_partkey, p_partkey}, {o_orderdate, l_shipdate}")))),(0,l.yg)("p",null,"\u7b2c\u4e8c\u6b65\uff1a\u6821\u9a8c\u7b49\u503c\u7b49\u4ef7\u7c7b"),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},"\u82e5 \u89c6\u56fe\u7b49\u4ef7\u8868\u8fbe\u5f0f = \u67e5\u8be2\u7b49\u4ef7\u8868\u8fbe\u5f0f\u7684\u5b50\u96c6\uff0c\u5219\u901a\u8fc7\u6821\u9a8c\u3002")),(0,l.yg)("p",null,"\u7b2c\u4e09\u6b65\uff1a\u8ba1\u7b97\u8303\u56f4\u8868\u8fbe\u5f0f"),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("p",{parentName:"li"},"\u89c6\u56fe\u8303\u56f4\u8868\u8fbe\u5f0f\uff1a",(0,l.yg)("inlineCode",{parentName:"p"},"{l_partkey, p_partkey} \u2208 (150, +\u221e), {o_custkey} \u2208 (50, 500)"))),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("p",{parentName:"li"},"\u67e5\u8be2\u8303\u56f4\u8868\u8fbe\u5f0f\uff1a ",(0,l.yg)("inlineCode",{parentName:"p"},"{l_partkey, p_partkey} \u2208 (150, 160), {o_custkey} \u2208 (123, 123)")))),(0,l.yg)("p",null,"\u7b2c\u56db\u6b65\uff1a\u6821\u9a8c\u8303\u56f4\u8868\u8fbe\u5f0f"),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("p",{parentName:"li"},"\u89c6\u56fe\u8303\u56f4\u8868\u8fbe\u5f0f\uff1a(150, 160) \u5728 (150, +\u221e) \u8303\u56f4\u5185")),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("p",{parentName:"li"},"\u67e5\u8be2\u8303\u56f4\u8868\u8fbe\u5f0f\uff1a(123, 123) \u5728 (50, 500) \u8303\u56f4\u5185"))),(0,l.yg)("p",null,"\u7b2c\u4e94\u6b65\uff1a\u6821\u9a8c\u8865\u507f\u8868\u8fbe\u5f0f"),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("p",{parentName:"li"},"\u89c6\u56fe\u8865\u507f\u8868\u8fbe\u5f0f\uff1ap_name like\u2018%abc%\u2019")),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("p",{parentName:"li"},"\u67e5\u8be2\u8865\u507f\u8868\u8fbe\u5f0f\uff1ap_name like\u2018%abc%\u2019"))),(0,l.yg)("p",null,"\u56e0\u4e3a ",(0,l.yg)("inlineCode",{parentName:"p"},"l_quantity*l_extendedprice > 100"),"\uff0c\u89c6\u56fe\u7684\u8865\u507f\u8868\u8fbe\u5f0f\u662f\u67e5\u8be2\u7684\u5b50\u96c6\u3002\u5728\u7ecf\u8fc7\u4ee5\u4e0a\u6b65\u9aa4\u6821\u9a8c\uff0c\u53ef\u4ee5\u4fdd\u8bc1\u6240\u6709\u7684\u884c\u4ece\u89c6\u56fe\u4e2d\u83b7\u53d6\uff0c\u9700\u8981\u5728\u89c6\u56fe\u4e0a\u6dfb\u52a0\u8865\u507f\u6761\u4ef6\uff0c\u8865\u507f\u6761\u4ef6\u5982\u4e0b\uff1a"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-sql"},"(o_orderdate = l_shipdate), \n({p_partkey,l_partkey} <= 160), \n(o_custkey = 123), and\n(l_quantity*l_extendedprice > 100.00).\n")),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"2. \u8865\u507f\u7684\u6761\u4ef6\u662f\u5426\u53ef\u4ee5\u4ece\u7269\u5316\u89c6\u56fe\u83b7\u53d6")),(0,l.yg)("p",null,"\u9700\u8981\u5bf9\u89c6\u56fe\u6dfb\u52a0\u8865\u507f\u6761\u4ef6\uff0c\u624d\u80fd\u4fdd\u8bc1\u6700\u7ec8\u83b7\u53d6\u7684\u6570\u636e\u548c\u539f\u59cb\u67e5\u8be2\u4e00\u81f4\u3002\u9700\u8981\u8fdb\u884c\u6821\u9a8c\uff0c\u9a8c\u8bc1\u8865\u507f\u6761\u4ef6\u4e2d\u9009\u62e9\u7684\u5217\u6216\u8868\u8fbe\u5f0f\u53ef\u4ee5\u4ece\u89c6\u56fe\u4e0a\u83b7\u53d6\u3002"),(0,l.yg)("p",null,"\u5373\u9700\u8981\u6821\u9a8c\u5217 ",(0,l.yg)("inlineCode",{parentName:"p"},"o_orderdate"),"\uff0c",(0,l.yg)("inlineCode",{parentName:"p"},"l_shipdate"),"\uff0c",(0,l.yg)("inlineCode",{parentName:"p"},"p_partkey"),"\uff0c",(0,l.yg)("inlineCode",{parentName:"p"},"{p_partkey, l_partkey}"),"\uff0c",(0,l.yg)("inlineCode",{parentName:"p"},"o_custkey")," \u4ee5\u53ca\u8868\u8fbe\u5f0f ",(0,l.yg)("inlineCode",{parentName:"p"},"l_quantity*l_extendedprice")," \u662f\u5426\u53ef\u4ece\u89c6\u56fe\u4e2d\u83b7\u53d6\u3002"),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"3. \u8868\u8fbe\u5f0f\u548c\u5217\u662f\u5426\u53ef\u4ece\u7269\u5316\u89c6\u56fe\u83b7\u53d6")),(0,l.yg)("p",null,"\u4e0e\u6821\u9a8c\u8865\u507f\u6761\u4ef6\u76f8\u4f3c\uff0c\u5982\u679c\u8f93\u51fa\u8868\u8fbe\u5f0f\u662f\u5e38\u91cf\uff0c\u53ef\u4ee5\u76f4\u63a5\u5728\u89c6\u56fe\u4e0a\u590d\u5236\u5e38\u91cf\uff1b\u5982\u679c\u662f\u7b80\u5355\u7684\u5217\u5f15\u7528\uff0c\u6821\u9a8c\u5b83\u662f\u5426\u53ef\u4ee5\u4ece\u89c6\u56fe\u4e2d\u83b7\u53d6\uff1b\u5bf9\u4e8e\u8868\u8fbe\u5f0f\uff0c\u5982\u679c\u8868\u8fbe\u5f0f\u7684\u5217\u53ef\u4ee5\u4ece\u7269\u5316\u89c6\u56fe\u4e2d\u83b7\u53d6\uff0c\u5c31\u76f4\u63a5\u83b7\u53d6\uff0c\u5426\u5219\u6821\u9a8c\u4e0d\u901a\u8fc7\u3002"),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"4. \u8f93\u51fa\u6570\u636e\u91cd\u590d\u5ea6\u4e00\u81f4\u6821\u9a8c")),(0,l.yg)("p",null,"\u5bf9\u4e8e\u67e5\u8be2\u548c\u4f7f\u7528\u7269\u5316\u89c6\u56fe\u540e\u83b7\u53d6\u7684\u6570\u636e\uff0c\u5bf9\u4e8e\u91cd\u590d\u7684\u884c\uff0c\u9700\u8981\u6709\u76f8\u540c\u7684\u91cd\u590d\u884c\u6570\u3002\u5982\u679c\u67e5\u8be2\u548c\u7269\u5316\u89c6\u56fe\u5f15\u7528\u7684\u8868\u76f8\u540c\uff0c\u5c31\u4e0d\u4f1a\u51fa\u73b0\u4e0a\u8ff0\u95ee\u9898\u3002\u53ea\u6709\u5f53\u67e5\u8be2\u548c\u7269\u5316\u89c6\u56fe\u5f15\u7528\u7684\u8868\u4e0d\u540c\u65f6\uff0c\u624d\u6709\u53ef\u80fd\u51fa\u73b0\u91cd\u590d\u7684\u884c\u4e14\u91cd\u590d\u884c\u6570\u4e0d\u540c\u7684\u60c5\u51b5\uff0c\u6bd4\u5982\u661f\u578b\u67e5\u8be2\u591a\u4e00\u4e2a\u8fde\u63a5\u5173\u7cfb\u65f6\uff0c\u5982\u679c\u8fde\u63a5\u952e\u4e0d\u662f\u4e3b\u5916\u952e\u7684\u5173\u7cfb\uff0c\u5c31\u5bb9\u6613\u9020\u6210\u6570\u636e\u81a8\u80c0\uff0c\u5bfc\u81f4\u6570\u636e\u91cd\u590d\u56e0\u6570\u4e0d\u4e00\u81f4\u3002"),(0,l.yg)("p",null,"\u901a\u5e38\u9700\u8981\u6821\u9a8c\u7269\u5316\u89c6\u56fe\u548c\u67e5\u8be2\u5728\u76f8\u540c\u8868\u60c5\u51b5\u4e0b\u7684 JOIN \u7c7b\u578b\uff0c\u4ee5\u53ca\u5728\u4e0d\u540c\u8868\u60c5\u51b5\u4e0b\u662f\u5426\u6ee1\u8db3 JOIN \u6d88\u9664\u3002"),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"5. \u805a\u5408\u6821\u9a8c")),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("p",{parentName:"li"},"\u7269\u5316\u7684\u7ef4\u5ea6\u662f\u5426\u6bd4\u67e5\u8be2\u66f4\u7ec6\uff0c\u662f\u5426\u5305\u542b\u67e5\u8be2\u7684\u7ef4\u5ea6")),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("p",{parentName:"li"},"\u67e5\u8be2\u4f7f\u7528\u7684\u805a\u5408\u51fd\u6570\u662f\u5426\u53ef\u4ee5\u4ece\u7269\u5316\u89c6\u56fe\u83b7\u53d6\uff0c\u6216\u8005\u662f\u5426\u53ef\u4ee5\u901a\u8fc7\u7269\u5316\u89c6\u56fe\u7684\u51fd\u6570\u4e0a\u5377\u83b7\u5f97\u3002"))))}E.isMDXComponent=!0},945592:(e,n,a)=>{a.d(n,{A:()=>t});const t=a.p+"assets/images/transparency-rewriting-011a673a27b3d576537fcd5a1244f45b.jpg"}}]);