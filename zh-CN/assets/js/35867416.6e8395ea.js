"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([[953381],{15680:(e,a,r)=>{r.d(a,{xA:()=>p,yg:()=>d});var n=r(296540);function m(e,a,r){return a in e?Object.defineProperty(e,a,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[a]=r,e}function l(e,a){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var a=1;a<arguments.length;a++){var r=null!=arguments[a]?arguments[a]:{};a%2?l(Object(r),!0).forEach((function(a){m(e,a,r[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))}))}return e}function t(e,a){if(null==e)return{};var r,n,m=function(e,a){if(null==e)return{};var r,n,m={},l=Object.keys(e);for(n=0;n<l.length;n++)r=l[n],a.indexOf(r)>=0||(m[r]=e[r]);return m}(e,a);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)r=l[n],a.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(m[r]=e[r])}return m}var i=n.createContext({}),y=function(e){var a=n.useContext(i),r=a;return e&&(r="function"==typeof e?e(a):o(o({},a),e)),r},p=function(e){var a=y(e.components);return n.createElement(i.Provider,{value:a},e.children)},s="mdxType",u={inlineCode:"code",wrapper:function(e){var a=e.children;return n.createElement(n.Fragment,{},a)}},c=n.forwardRef((function(e,a){var r=e.components,m=e.mdxType,l=e.originalType,i=e.parentName,p=t(e,["components","mdxType","originalType","parentName"]),s=y(r),c=m,d=s["".concat(i,".").concat(c)]||s[c]||u[c]||l;return r?n.createElement(d,o(o({ref:a},p),{},{components:r})):n.createElement(d,o({ref:a},p))}));function d(e,a){var r=arguments,m=a&&a.mdxType;if("string"==typeof e||m){var l=r.length,o=new Array(l);o[0]=c;var t={};for(var i in a)hasOwnProperty.call(a,i)&&(t[i]=a[i]);t.originalType=e,t[s]="string"==typeof e?e:m,o[1]=t;for(var y=2;y<l;y++)o[y]=r[y];return n.createElement.apply(null,o)}return n.createElement.apply(null,r)}c.displayName="MDXCreateElement"},109251:(e,a,r)=>{r.r(a),r.d(a,{assets:()=>i,contentTitle:()=>o,default:()=>u,frontMatter:()=>l,metadata:()=>t,toc:()=>y});var n=r(58168),m=(r(296540),r(15680));const l={title:"\u5185\u5b58\u95ee\u9898 FAQ",language:"zh-CN"},o=void 0,t={unversionedId:"admin-manual/memory-management/memory-issue-faq",id:"version-3.0/admin-manual/memory-management/memory-issue-faq",title:"\u5185\u5b58\u95ee\u9898 FAQ",description:"\x3c!--",source:"@site/i18n/zh-CN/docusaurus-plugin-content-docs/version-3.0/admin-manual/memory-management/memory-issue-faq.md",sourceDirName:"admin-manual/memory-management",slug:"/admin-manual/memory-management/memory-issue-faq",permalink:"/zh-CN/docs/3.0/admin-manual/memory-management/memory-issue-faq",draft:!1,tags:[],version:"3.0",frontMatter:{title:"\u5185\u5b58\u95ee\u9898 FAQ",language:"zh-CN"},sidebar:"docs",previous:{title:"\u6982\u8ff0",permalink:"/zh-CN/docs/3.0/admin-manual/memory-management/overview"},next:{title:"Jemalloc \u5185\u5b58\u5206\u6790",permalink:"/zh-CN/docs/3.0/admin-manual/memory-management/memory-analysis/jemalloc-memory-analysis"}},i={},y=[{value:"1 \u67e5\u8be2\u548c\u5bfc\u5165\u5185\u5b58\u8d85\u9650\u9519\u8bef",id:"1-\u67e5\u8be2\u548c\u5bfc\u5165\u5185\u5b58\u8d85\u9650\u9519\u8bef",level:2},{value:"2 Doris BE OOM Crash",id:"2-doris-be-oom-crash",level:2},{value:"3 \u5185\u5b58\u6cc4\u6f0f",id:"3-\u5185\u5b58\u6cc4\u6f0f",level:2},{value:"4 Doris BE \u8fdb\u7a0b\u5185\u5b58\u4e0d\u4e0b\u964d OR \u6301\u7eed\u4e0a\u6da8",id:"4-doris-be-\u8fdb\u7a0b\u5185\u5b58\u4e0d\u4e0b\u964d-or-\u6301\u7eed\u4e0a\u6da8",level:2},{value:"5 \u865a\u62df\u5185\u5b58\u5360\u7528\u5927",id:"5-\u865a\u62df\u5185\u5b58\u5360\u7528\u5927",level:2},{value:"6 BE \u8fdb\u7a0b\u521a\u542f\u52a8\u540e\u8fdb\u7a0b\u5185\u5b58\u5c31\u5f88\u5927",id:"6-be-\u8fdb\u7a0b\u521a\u542f\u52a8\u540e\u8fdb\u7a0b\u5185\u5b58\u5c31\u5f88\u5927",level:2},{value:"7 Query \u6ca1\u6709\u590d\u6742\u7b97\u5b50\u53ea\u662f\u7b80\u5355\u7684 Scan \u6570\u636e\uff0c\u5374\u8981\u4f7f\u7528\u5f88\u5927\u7684\u5185\u5b58",id:"7-query-\u6ca1\u6709\u590d\u6742\u7b97\u5b50\u53ea\u662f\u7b80\u5355\u7684-scan-\u6570\u636e\u5374\u8981\u4f7f\u7528\u5f88\u5927\u7684\u5185\u5b58",level:2},{value:"8. Query Cancel \u8fc7\u7a0b\u4e2d\u5361\u4f4f",id:"8-query-cancel-\u8fc7\u7a0b\u4e2d\u5361\u4f4f",level:2}],p={toc:y},s="wrapper";function u(e){let{components:a,...r}=e;return(0,m.yg)(s,(0,n.A)({},p,r,{components:a,mdxType:"MDXLayout"}),(0,m.yg)("p",null,"Doris BE \u8fdb\u7a0b\u5185\u5b58\u5206\u6790\u4e3b\u8981\u4f7f\u7528 ",(0,m.yg)("inlineCode",{parentName:"p"},"be/log/be.INFO")," \u65e5\u5fd7\u3001BE \u8fdb\u7a0b\u5185\u5b58\u76d1\u63a7(Metrics)\u3001Doris Bvar \u7edf\u8ba1\uff0c\u5982\u679c\u89e6\u53d1\u4e86 OOM Killer \u9700\u8981\u6536\u96c6 ",(0,m.yg)("inlineCode",{parentName:"p"},"dmesg -T")," \u6267\u884c\u7ed3\u679c\uff0c\u5982\u679c\u5206\u6790\u67e5\u8be2\u6216\u5bfc\u5165\u4efb\u52a1\u7684\u5185\u5b58\u9700\u8981\u6536\u96c6 Query Profile\uff0c\u4f9d\u636e\u8fd9\u4e9b\u4fe1\u606f\u5206\u6790\u5e38\u89c1\u7684\u5185\u5b58\u95ee\u9898\u3002\u5982\u679c\u4f60\u81ea\u884c\u5206\u6790\u65e0\u6cd5\u89e3\u51b3\u95ee\u9898\uff0c\u9700\u8981\u5411 Doris \u5f00\u53d1\u8005\u4eec\u6c42\u52a9\uff0c\u65e0\u8bba\u4f7f\u7528\u4f55\u79cd\u9014\u5f84\uff08Github \u63d0\u4ea4 issue\uff0cDoris \u8bba\u575b\u521b\u5efa\u95ee\u9898\uff0c\u90ae\u4ef6\u6216 WeChat\uff09\uff0c\u90fd\u8bf7\u5c06\u4e0a\u8ff0\u4fe1\u606f\u6dfb\u52a0\u5230\u4f60\u7684\u95ee\u9898\u63cf\u8ff0\u4e2d\u3002"),(0,m.yg)("p",null,"\u9996\u5148\u5b9a\u4f4d\u5f53\u524d\u89c2\u5bdf\u5230\u7684\u73b0\u8c61\u5c5e\u4e8e\u54ea\u79cd\u5185\u5b58\u95ee\u9898\uff0c\u5e76\u8fdb\u4e00\u6b65\u6392\u67e5\uff0c\u901a\u5e38\u9700\u8981\u5148\u5206\u6790\u8fdb\u7a0b\u5185\u5b58\u65e5\u5fd7\uff0c\u53c2\u8003 ",(0,m.yg)("a",{parentName:"p",href:"/zh-CN/docs/3.0/admin-manual/memory-management/memory-analysis/memory-log-analysis"},"\u5185\u5b58\u65e5\u5fd7\u5206\u6790"),"\uff0c\u4e0b\u9762\u5217\u4e3e\u5e38\u89c1\u7684\u5185\u5b58\u95ee\u9898\u3002"),(0,m.yg)("h2",{id:"1-\u67e5\u8be2\u548c\u5bfc\u5165\u5185\u5b58\u8d85\u9650\u9519\u8bef"},"1 \u67e5\u8be2\u548c\u5bfc\u5165\u5185\u5b58\u8d85\u9650\u9519\u8bef"),(0,m.yg)("p",null,"\u5f53\u67e5\u8be2\u548c\u5bfc\u5165\u7684\u62a5\u9519\u4fe1\u606f\u4e2d\u51fa\u73b0 ",(0,m.yg)("inlineCode",{parentName:"p"},"MEM_LIMIT_EXCEEDED")," \u65f6\uff0c\u8bf4\u660e\u4efb\u52a1\u56e0\u4e3a\u8fdb\u7a0b\u53ef\u7528\u5185\u5b58\u4e0d\u8db3\uff0c\u6216\u4efb\u52a1\u8d85\u8fc7\u5355\u6b21\u6267\u884c\u7684\u5185\u5b58\u4e0a\u9650\u800c\u88ab Cancel\u3002"),(0,m.yg)("pre",null,(0,m.yg)("code",{parentName:"pre",className:"language-sql"},"ERROR 1105 (HY000): errCode = 2, detailMessage = (10.16.10.8)[MEM_LIMIT_EXCEEDED] xxxx .\n")),(0,m.yg)("p",null,"\u82e5\u62a5\u9519\u4fe1\u606f\u5305\u542b ",(0,m.yg)("inlineCode",{parentName:"p"},"Process memory not enough"),"\uff0c\u8bf4\u660e\u8fdb\u7a0b\u53ef\u7528\u5185\u5b58\u4e0d\u8db3\uff0c\u53c2\u8003 ",(0,m.yg)("a",{parentName:"p",href:"/zh-CN/docs/3.0/admin-manual/memory-management/memory-analysis/query-cancelled-after-process-memory-exceeded"},"\u67e5\u8be2\u6216\u5bfc\u5165\u62a5\u9519\u8fdb\u7a0b\u53ef\u7528\u5185\u5b58\u4e0d\u8db3")," \u8fdb\u4e00\u6b65\u5206\u6790\u3002"),(0,m.yg)("p",null,"\u82e5\u62a5\u9519\u4fe1\u606f\u4e2d\u51fa\u73b0 ",(0,m.yg)("inlineCode",{parentName:"p"},"memory tracker limit exceeded")," \u65f6\uff0c\u8bf4\u660e\u4efb\u52a1\u8d85\u8fc7\u5355\u6b21\u6267\u884c\u5185\u5b58\u9650\u5236\uff0c\u53c2\u8003 ",(0,m.yg)("a",{parentName:"p",href:"/zh-CN/docs/3.0/admin-manual/memory-management/memory-analysis/query-cancelled-after-query-memory-exceeded"},"\u67e5\u8be2\u6216\u5bfc\u5165\u62a5\u9519\u8d85\u8fc7\u5355\u6b21\u6267\u884c\u5185\u5b58\u9650\u5236")," \u8fdb\u4e00\u6b65\u5206\u6790\u3002"),(0,m.yg)("h2",{id:"2-doris-be-oom-crash"},"2 Doris BE OOM Crash"),(0,m.yg)("p",null,"\u5982\u679c BE \u8fdb\u7a0b Crash \u540e ",(0,m.yg)("inlineCode",{parentName:"p"},"log/be.out")," \u4e2d\u6ca1\u6709\u62a5\u9519\u4fe1\u606f\uff0c\u6267\u884c ",(0,m.yg)("inlineCode",{parentName:"p"},"dmesg -T")," \u5982\u679c\u770b\u5230 ",(0,m.yg)("inlineCode",{parentName:"p"},"Out of memory: Killed process {pid} (doris_be)"),"\uff0c\u8bf4\u660e\u89e6\u53d1\u4e86 OOM Killer\uff0c\u53c2\u8003 ",(0,m.yg)("a",{parentName:"p",href:"/zh-CN/docs/3.0/admin-manual/memory-management/memory-analysis/oom-crash-analysis"},"OOM Killer Crash \u5206\u6790")," \u8fdb\u4e00\u6b65\u5206\u6790\u3002"),(0,m.yg)("h2",{id:"3-\u5185\u5b58\u6cc4\u6f0f"},"3 \u5185\u5b58\u6cc4\u6f0f"),(0,m.yg)("blockquote",null,(0,m.yg)("p",{parentName:"blockquote"},"\u5982\u679c\u9047\u5230\u7591\u4f3c\u5185\u5b58\u6cc4\u6f0f\u7684\u73b0\u8c61\uff0c\u6700\u597d\u7684\u89e3\u51b3\u529e\u6cd5\u662f\u5347\u7ea7\u5230\u6700\u65b0\u7684\u4e09\u4f4d\u6570\u7248\u672c\uff0c\u5982\u679c\u4f60\u5728\u7528 Doris 2.0\uff0c\u5c31\u5347\u7ea7\u5230 Doris 2.0.x \u7684\u6700\u65b0\u7248\u672c\uff0c\u56e0\u4e3a\u5927\u6982\u7387\u5176\u4ed6\u4eba\u4e5f\u9047\u5230\u8fc7\u540c\u6837\u7684\u73b0\u8c61\uff0c\u5927\u90e8\u5206\u5185\u5b58\u6cc4\u6f0f\u95ee\u9898\u90fd\u5728\u7248\u672c\u8fed\u4ee3\u4e2d\u88ab\u4fee\u590d\u3002")),(0,m.yg)("p",null,"\u5982\u679c\u89c2\u5bdf\u5230\u4e0b\u9762\u7684\u73b0\u8c61\uff0c\u8bf4\u660e\u53ef\u80fd\u5b58\u5728\u5185\u5b58\u6cc4\u6f0f\uff1a"),(0,m.yg)("ul",null,(0,m.yg)("li",{parentName:"ul"},(0,m.yg)("p",{parentName:"li"},"Doris Grafana \u6216\u670d\u52a1\u5668\u76d1\u63a7\u53d1\u73b0 Doris BE \u8fdb\u7a0b\u5185\u5b58\u4e00\u76f4\u7ebf\u6027\u589e\u957f\uff0c\u4e14\u96c6\u7fa4\u4e0a\u4efb\u52a1\u505c\u6b62\u540e\uff0c\u5185\u5b58\u4e5f\u4e0d\u4e0b\u964d\u3002")),(0,m.yg)("li",{parentName:"ul"},(0,m.yg)("p",{parentName:"li"},"Memory Tracker \u5b58\u5728\u7edf\u8ba1\u7f3a\u5931\uff0c\u53c2\u8003 ",(0,m.yg)("a",{parentName:"p",href:"/zh-CN/docs/3.0/admin-manual/memory-management/memory-feature/memory-tracker"},"\u5185\u5b58\u8ddf\u8e2a\u5668")," \u4e2d ","[Memory Tracker \u7edf\u8ba1\u7f3a\u5931]"," \u7ae0\u8282\u5206\u6790\u3002"))),(0,m.yg)("p",null,"\u5185\u5b58\u6cc4\u6f0f\u901a\u5e38\u90fd\u4f34\u968f\u7740 Memory Tracker \u7edf\u8ba1\u7f3a\u5931\uff0c\u6240\u4ee5\u5206\u6790\u65b9\u6cd5\u540c\u6837\u53c2\u8003 ","[Memory Tracker \u7edf\u8ba1\u7f3a\u5931]"," \u7ae0\u8282\u3002"),(0,m.yg)("h2",{id:"4-doris-be-\u8fdb\u7a0b\u5185\u5b58\u4e0d\u4e0b\u964d-or-\u6301\u7eed\u4e0a\u6da8"},"4 Doris BE \u8fdb\u7a0b\u5185\u5b58\u4e0d\u4e0b\u964d OR \u6301\u7eed\u4e0a\u6da8"),(0,m.yg)("p",null,"\u5982\u679c Doris Grafana \u6216\u670d\u52a1\u5668\u76d1\u63a7\u53d1\u73b0 Doris BE \u8fdb\u7a0b\u5185\u5b58\u4e00\u76f4\u7ebf\u6027\u589e\u957f\uff0c\u4e14\u96c6\u7fa4\u4e0a\u4efb\u52a1\u505c\u6b62\u540e\uff0c\u5185\u5b58\u4e5f\u4e0d\u4e0b\u964d\uff0c\u9996\u5148\u53c2\u8003 ",(0,m.yg)("a",{parentName:"p",href:"/zh-CN/docs/3.0/admin-manual/memory-management/memory-feature/memory-tracker"},"\u5185\u5b58\u8ddf\u8e2a\u5668")," \u4e2d ","[Memory Tracker \u7edf\u8ba1\u7f3a\u5931]"," \u7ae0\u8282\u5206\u6790\u662f\u5426\u5b58\u5728 Memory Tracker \u7edf\u8ba1\u7f3a\u5931\uff0c\u82e5 Memory Tracker \u5b58\u5728\u7edf\u8ba1\u7f3a\u5931\u5219\u8fdb\u4e00\u6b65\u5206\u6790\u539f\u56e0\u3002"),(0,m.yg)("p",null,"\u82e5 Memory Tracker \u4e0d\u5b58\u5728\u7edf\u8ba1\u7f3a\u5931\uff0c\u7edf\u8ba1\u5230\u4e86\u5927\u90e8\u5206\u5185\u5b58\uff0c\u53c2\u8003 ",(0,m.yg)("a",{parentName:"p",href:"/zh-CN/docs/3.0/admin-manual/memory-management/overview"},"Overview")," \u5206\u6790 Doris BE \u8fdb\u7a0b\u4e0d\u540c\u90e8\u5206\u5185\u5b58\u5360\u7528\u8fc7\u5927\u7684\u539f\u56e0\u4ee5\u53ca\u51cf\u5c11\u5176\u5185\u5b58\u4f7f\u7528\u7684\u65b9\u6cd5\u3002"),(0,m.yg)("h2",{id:"5-\u865a\u62df\u5185\u5b58\u5360\u7528\u5927"},"5 \u865a\u62df\u5185\u5b58\u5360\u7528\u5927"),(0,m.yg)("p",null,(0,m.yg)("inlineCode",{parentName:"p"},"Label=process virtual memory")," Memory Tracker \u663e\u793a\u5b9e\u65f6\u7684\u865a\u62df\u5185\u5b58\u5927\u5c0f\uff0c\u548c ",(0,m.yg)("inlineCode",{parentName:"p"},"top -p {pid}")," \u770b\u5230\u7684 Doris BE \u8fdb\u7a0b\u865a\u62df\u5185\u5b58\u76f8\u540c\u3002"),(0,m.yg)("pre",null,(0,m.yg)("code",{parentName:"pre"},"MemTrackerLimiter Label=process virtual memory, Type=overview, Limit=-1.00 B(-1 B), Used=44.25 GB(47512956928 B), Peak=44.25 GB(47512956928 B)\n")),(0,m.yg)("p",null,"Doris \u76ee\u524d\u4ecd\u5b58\u5728 Doris BE \u8fdb\u7a0b\u865a\u62df\u5185\u5b58\u8fc7\u5927\u7684\u95ee\u9898\uff0c\u901a\u5e38\u662f\u56e0\u4e3a Jemalloc \u4fdd\u7559\u4e86\u5927\u91cf\u865a\u62df\u5185\u5b58\u6620\u5c04\uff0c\u8fd9\u4e5f\u5c06\u5bfc\u81f4 Jemalloc Metadata \u5360\u7528\u8fc7\u591a\u7684\u5185\u5b58\uff0c\u53c2\u8003 ",(0,m.yg)("a",{parentName:"p",href:"/zh-CN/docs/3.0/admin-manual/memory-management/memory-analysis/jemalloc-memory-analysis"},"Jemalloc \u5185\u5b58\u5206\u6790")," \u4e2d\u5bf9 Jemalloc Metadata \u5185\u5b58\u7684\u5206\u6790\u3002"),(0,m.yg)("p",null,"\u9664\u6b64\u4e4b\u5916\u5df2\u77e5 Doris \u7684 Join Operator \u548c Column \u4e2d\u7f3a\u5c11\u5185\u5b58\u590d\u7528\uff0c\u8fd9\u4f1a\u5bfc\u81f4\u5728\u67d0\u4e9b\u573a\u666f\u7533\u8bf7\u66f4\u591a\u7684\u865a\u62df\u5185\u5b58\uff0c\u5e76\u6700\u7ec8\u7f13\u5b58\u5230 Jemalloc Retained \u4e2d\uff0c\u76ee\u524d\u6ca1\u6709\u5f88\u597d\u7684\u89e3\u51b3\u529e\u6cd5\uff0c\u5efa\u8bae\u5b9a\u671f\u91cd\u542f Doris BE \u8fdb\u7a0b\u3002"),(0,m.yg)("h2",{id:"6-be-\u8fdb\u7a0b\u521a\u542f\u52a8\u540e\u8fdb\u7a0b\u5185\u5b58\u5c31\u5f88\u5927"},"6 BE \u8fdb\u7a0b\u521a\u542f\u52a8\u540e\u8fdb\u7a0b\u5185\u5b58\u5c31\u5f88\u5927"),(0,m.yg)("p",null,"\u8fd9\u901a\u5e38\u662f\u56e0\u4e3a BE \u8fdb\u7a0b\u542f\u52a8\u65f6\u52a0\u8f7d\u7684\u5143\u6570\u636e\u5185\u5b58\u8fc7\u5927\uff0c\u53c2\u8003 ",(0,m.yg)("a",{parentName:"p",href:"/zh-CN/docs/3.0/admin-manual/memory-management/memory-analysis/metadata-memory-analysis"},"Metadata \u5185\u5b58\u5206\u6790")," \u67e5\u770b Doris BE Bvar\u3002"),(0,m.yg)("ul",null,(0,m.yg)("li",{parentName:"ul"},(0,m.yg)("p",{parentName:"li"},"\u5982\u679c ",(0,m.yg)("inlineCode",{parentName:"p"},"doris_total_tablet_num")," \u8fc7\u591a\uff0c\u901a\u5e38\u662f\u56e0\u4e3a\u8868\u7684\u5206\u533a\u548c\u5206\u6876\u6570\u91cf\u8fc7\u591a\uff0c\u67e5\u770b ",(0,m.yg)("inlineCode",{parentName:"p"},"{fe_host}:{fe_http_port}/System?path=//dbs")," \u627e\u5230 Tablet \u6570\u91cf\u591a\u7684\u8868\uff0c\u4e00\u4e2a\u8868\u7684 Tablet \u6570\u91cf\u7b49\u4e8e\u5176\u5206\u533a\u6570\u91cf\u4e58\u4ee5\u5206\u6876\u6570\u91cf\uff0c\u5c1d\u8bd5\u964d\u4f4e\u5176\u5206\u533a\u548c\u5206\u6876\u6570\u91cf\u3002\u6216\u8005\u5220\u9664\u8fc7\u65f6\u4e0d\u4f1a\u88ab\u4f7f\u7528\u7684\u8868\u6216\u5206\u533a\u3002")),(0,m.yg)("li",{parentName:"ul"},(0,m.yg)("p",{parentName:"li"},"\u5982\u679c ",(0,m.yg)("inlineCode",{parentName:"p"},"doris_total_rowset_num")," \u8fc7\u591a\uff0c\u4f46 Tablet \u6570\u91cf\u4e0d\u591a\uff0c\u53c2\u8003 ",(0,m.yg)("inlineCode",{parentName:"p"},"SHOW-PROC")," \u6587\u6863\u627e\u5230 Rowset \u591a\u4f46 Tablet \u4e0d\u591a\u7684\u8868\uff0c\u7136\u540e\u624b\u52a8\u89e6\u53d1 Compaction\uff0c\u6216\u8005\u7b49\u81ea\u52a8 Compaction \u5b8c\u6210\uff0c\u5177\u4f53\u53c2\u8003\u5143\u6570\u636e\u7ba1\u7406\u76f8\u5173\u6587\u6863\uff0c\u901a\u5e38\u5b58\u5728\u51e0\u5341\u4e07\u4e2a Rowset \u65f6\uff0c\u5143\u6570\u636e\u5360\u7528\u51e0\u4e2a GB \u662f\u6b63\u5e38\u73b0\u8c61\u3002")),(0,m.yg)("li",{parentName:"ul"},(0,m.yg)("p",{parentName:"li"},"\u5982\u679c ",(0,m.yg)("inlineCode",{parentName:"p"},"tablet_meta_schema_columns_count")," \u8fc7\u5927\uff0c\u662f ",(0,m.yg)("inlineCode",{parentName:"p"},"doris_total_tablet_schema_num")," \u7684\u6210\u767e\u4e0a\u5343\u500d\uff0c\u8bf4\u660e\u96c6\u7fa4\u4e2d\u5b58\u5728\u51e0\u767e\u4e0a\u5343\u5217\u7684\u5927\u5bbd\u8868\uff0c\u6b64\u65f6\u76f8\u540c\u6570\u91cf\u7684 Tablet \u4f1a\u5360\u7528\u66f4\u591a\u7684\u5185\u5b58\u3002"))),(0,m.yg)("h2",{id:"7-query-\u6ca1\u6709\u590d\u6742\u7b97\u5b50\u53ea\u662f\u7b80\u5355\u7684-scan-\u6570\u636e\u5374\u8981\u4f7f\u7528\u5f88\u5927\u7684\u5185\u5b58"},"7 Query \u6ca1\u6709\u590d\u6742\u7b97\u5b50\u53ea\u662f\u7b80\u5355\u7684 Scan \u6570\u636e\uff0c\u5374\u8981\u4f7f\u7528\u5f88\u5927\u7684\u5185\u5b58"),(0,m.yg)("p",null,"\u53ef\u80fd\u662f\u8bfb\u53d6 Segment \u65f6\u6253\u5f00\u7684 Column Reader\u3001Index Read \u5360\u7528\u7684\u5185\u5b58\uff0c\u53c2\u8003 ",(0,m.yg)("a",{parentName:"p",href:"/zh-CN/docs/3.0/admin-manual/memory-management/memory-analysis/metadata-memory-analysis"},"Metadata \u5185\u5b58\u5206\u6790")," \u67e5\u770b Doris BE Bvar \u4e2d\u7684 ",(0,m.yg)("inlineCode",{parentName:"p"},"doris_total_segment_num"),"\u3001",(0,m.yg)("inlineCode",{parentName:"p"},"doris_column_reader_num"),"\u3001",(0,m.yg)("inlineCode",{parentName:"p"},"doris_ordinal_index_memory_bytes"),"\u3001",(0,m.yg)("inlineCode",{parentName:"p"},"doris_zone_map_memory_bytes"),"\u3001",(0,m.yg)("inlineCode",{parentName:"p"},"doris_short_key_index_memory_bytes"),"\u7684\u53d8\u5316\uff0c\u8fd9\u4e2a\u73b0\u8c61\u540c\u6837\u5e38\u89c1\u4e8e\u8bfb\u53d6\u5927\u5bbd\u8868\uff0c\u5f53\u6253\u5f00\u51e0\u5341\u4e07\u4e2a Column Reader \u65f6\uff0c\u5185\u5b58\u53ef\u80fd\u4f1a\u5360\u7528\u51e0\u5341GB\u3002"),(0,m.yg)("p",null,"\u5982\u679c\u4f60\u5728 Heap Profile \u5185\u5b58\u5360\u6bd4\u5927\u7684\u8c03\u7528\u6808\u4e2d\u770b\u5230 ",(0,m.yg)("inlineCode",{parentName:"p"},"Segment"),"\uff0c",(0,m.yg)("inlineCode",{parentName:"p"},"ColumnReader")," \u5b57\u6bb5\uff0c\u5219\u57fa\u672c\u53ef\u4ee5\u786e\u8ba4\u662f\u8bfb\u53d6 Segment \u65f6\u5360\u7528\u4e86\u5927\u91cf\u5185\u5b58\u3002"),(0,m.yg)("p",null,"\u6b64\u65f6\u53ea\u80fd\u901a\u8fc7\u4fee\u6539 SQL \u964d\u4f4e\u626b\u63cf\u7684\u6570\u636e\u91cf\uff0c\u6216\u8005\u964d\u4f4e\u5efa\u8868\u65f6\u6307\u5b9a\u7684\u5206\u6876\u5927\u5c0f\uff0c\u4ece\u800c\u6253\u5f00\u66f4\u5c11\u7684 Segment\u3002"),(0,m.yg)("h2",{id:"8-query-cancel-\u8fc7\u7a0b\u4e2d\u5361\u4f4f"},"8. Query Cancel \u8fc7\u7a0b\u4e2d\u5361\u4f4f"),(0,m.yg)("blockquote",null,(0,m.yg)("p",{parentName:"blockquote"},"\u5e38\u89c1\u4e8e Doris 2.1.3 \u4e4b\u524d")),(0,m.yg)("p",null,"Query \u6267\u884c\u671f\u95f4\u7533\u8bf7\u7684\u5927\u90e8\u5206\u5185\u5b58\u9700\u8981\u7b49\u5230\u67e5\u8be2\u7ed3\u675f\u65f6\u91ca\u653e\uff0c\u5728\u8fdb\u7a0b\u5185\u5b58\u5145\u8db3\u65f6\u901a\u5e38\u65e0\u9700\u5173\u6ce8\u67e5\u8be2\u7ed3\u675f\u9636\u6bb5\u7684\u5feb\u6216\u6162\uff0c\u4f46\u5728\u8fdb\u7a0b\u5185\u5b58\u4e0d\u8db3\u65f6\u7ecf\u5e38\u4f1a\u6309\u7167\u4e00\u5b9a\u7b56\u7565 Cancel \u90e8\u5206 Query\uff0c\u4ee5\u91ca\u653e\u5b83\u4eec\u7684\u5185\u5b58\uff0c\u907f\u514d\u8fdb\u7a0b\u89e6\u53d1 OOM Killer\u3002\u6b64\u65f6\u5982\u679c Query Cancel \u8fc7\u7a0b\u4e2d\u5361\u4f4f\uff0c\u65e0\u6cd5\u53ca\u65f6\u91ca\u653e\u5185\u5b58\uff0c\u9664\u4e86\u4f1a\u589e\u5927\u89e6\u53d1 OOM Killer \u7684\u98ce\u9669\uff0c\u4e5f\u53ef\u80fd\u4f1a\u5bfc\u81f4\u66f4\u591a\u7684 Query \u56e0\u8fdb\u7a0b\u5185\u5b58\u4e0d\u8db3\u800c\u88ab Cancel\u3002"),(0,m.yg)("p",null,"\u82e5\u5df2\u77e5\u4e00\u4e2a Query \u88ab Cancel\uff0c\u4e0b\u9762\u4f9d\u636e\u8fd9\u4e2a QueryID \u5206\u6790\u5176\u518d Cancel \u8fc7\u7a0b\u4e2d\u662f\u5426\u5361\u4f4f\u3002\u9996\u5148\u6267\u884c ",(0,m.yg)("inlineCode",{parentName:"p"},"grep {queryID} be/log/be.INFO"),"\uff0c\u627e\u5230\u7b2c\u4e00\u6b21\u5305\u542b ",(0,m.yg)("inlineCode",{parentName:"p"},"Cancel")," \u5173\u952e\u8bcd\u7684\u65e5\u5fd7\uff0c\u5bf9\u5e94\u65f6\u95f4\u70b9\u5c31\u662f Query \u88ab Cancel \u7684\u65f6\u95f4\u3002\u627e\u5230\u5305\u542b ",(0,m.yg)("inlineCode",{parentName:"p"},"deregister query/load memory tracker")," \u5173\u952e\u8bcd\u7684\u65e5\u5fd7\uff0c\u5bf9\u5e94\u7684\u65f6\u95f4\u70b9\u5c31\u662f Query Cancel \u5b8c\u6210\u7684\u65f6\u95f4\uff0c\u82e5\u6700\u7ec8\u89e6\u53d1\u4e86 OOM Killer\uff0c\u65e0\u6cd5\u627e\u5230\u5305\u542b ",(0,m.yg)("inlineCode",{parentName:"p"},"deregister query/load memory tracker")," \u5173\u952e\u8bcd\u7684\u65e5\u5fd7\uff0c\u8bf4\u660e\u76f4\u5230 OOM Killer \u53d1\u751f\u65f6\u8fd9\u4e2a Query \u4ecd\u6ca1\u6709 Cancel \u5b8c\u6210\uff0c\u901a\u5e38\u82e5 Query Cancel \u8fc7\u7a0b\u7684\u597d\u65f6\u5927\u4e8e 3s\uff0c\u5c31\u4efb\u52a1\u8fd9\u4e2a Query \u5728 Cancel \u8fc7\u7a0b\u4e2d\u5361\u4f4f\uff0c\u9700\u8981\u8fdb\u4e00\u6b65\u5206\u6790 Query \u6267\u884c\u65e5\u5fd7\u3002"),(0,m.yg)("p",null,"\u6b64\u5916\uff0c\u5728\u6267\u884c ",(0,m.yg)("inlineCode",{parentName:"p"},"grep {queryID} be/log/be.INFO")," \u540e\uff0c\u82e5\u770b\u5230\u5305\u542b ",(0,m.yg)("inlineCode",{parentName:"p"},"tasks is being canceled and has not been completed yet")," \u5173\u952e\u8bcd\u7684\u65e5\u5fd7\uff0c\u5176\u540e\u9762\u7684 QueryID \u5217\u8868\u662f\u8868\u793a Memory GC \u65f6\u53d1\u73b0\u8fd9\u4e9b Query \u6b63\u5728\u88ab Cancel \u4f46\u6ca1\u6709 Cancel \u5b8c\u6210\uff0c\u6b64\u65f6\u5c06\u8df3\u8fc7\u8fd9\u4e9b Query\uff0c\u7ee7\u7eed\u91ca\u653e\u522b\u5904\u7684\u5185\u5b58\uff0c\u53ef\u636e\u6b64\u5224\u65ad Memory GC \u7684\u884c\u4e3a\u662f\u5426\u7b26\u5408\u9884\u671f\u3002"))}u.isMDXComponent=!0}}]);